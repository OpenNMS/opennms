---
# Sentinel configuration schema
#
# See the readme SENTINEL_CONFIG_SCHEMA_README.md for more information.

# Version of Sentinel this schema configuration is applicable to
version: "@VERSION@"
revision: "@REVISION@"
branch: "@BRANCH@"
buildnumber: @BUILD_NUMBER@

# The root set of categories configurable on a Sentinel container. Ordering here is used only to determine order for
# display purposes.
categories:
  # General
  - name: "general"
    label: "General"
    description: "Generic Sentinel configuration settings"
    config:
      - name: "instance-id"
        type:
          name: "string"
          validation: "TODO"
        label: "Core instance ID"
        description: "Identifier for core instance used as queue prefix in message broker"
        key: "/org.opennms.instance.id"
        example: "OpenNMS"
      - name: "system-properties"
        type:
          name: "properties"
        label: "System Properties"
        description: "Generic Java system properties"
        key: "/system/properties"
        example: "JAEGER_AGENT_HOST: my-jaeger-host"
    categories:
      - name: "elasticsearch"
        label: "Sentinel Elasticsearch Configuration"
        description: "Sentinel Elasticsearch configuration"
        config:
          - name: "url"
            type:
              name: "string"
              validation: "TODO"
            label: "Url"
            description: "Elasticsearch Url"
            key: "/elastic/url"
            example: "http://elastic-ip:9200"
          - name: "index-strategy"
            type:
              name: "string"
              validation: "TODO"
            label: "Url"
            description: "Elasticsearch Index Strategy"
            key: "/elastic/index-stratey"
            example: "hourly"
          - name: "replicas"
            type:
              name: "string"
              validation: "TODO"
            label: "Replicas"
            description: "Elasticsearch Replicas"
            key: "/elastic/replicas"
            example: "0"
          - name: "conn-timeout"
            type:
              name: "string"
              validation: "TODO"
            label: "Connection Timeout"
            description: "Elasticsearch Connection Timeout"
            key: "/elastic/conn-timeout"
            example: "30000"
          - name: "read-timeout"
            type:
              name: "string"
              validation: "TODO"
            label: "Read Timeout"
            description: "Elasticsearch Read Timeout"
            key: "/elastic/read-timeout"
            example: "60000"
      - name: "datasource"
        label: "Sentinel Datasource"
        description: "Sentinel datasource configuration"
        config:
          - name: "url"
            type:
              name: "string"
              validation: "TODO"
            label: "Url"
            description: "Datasource Url"
            key: "/datasource/url"
            example: "jdbc:postgresql://localhost:5432/opennms"
          - name: "username"
            type:
              name: "string"
              validation: "TODO"
            label: "Url"
            description: "Datasource Username"
            key: "/datasource/username"
            example: "opennms"
          - name: "password"
            type:
              name: "string"
              validation: "TODO"
            label: "Url"
            description: "Datasource Password"
            key: "/datasource/password"
            example: "secret123!"
          - name: "database-name"
            type:
              name: "string"
              validation: "TODO"
            label: "Database name"
            description: "Datasource Database Name"
            key: "/datasource/database-name"
            example: "opennms"
      # General :: Controller
      - name: "controller"
        label: "Sentinel Controller"
        description: "Sentinel controller configuration for a location and communication endpoints"
        config:
          - name: "location"
            type:
              name: "string"
              validation: "TODO"
            label: "Location"
            description: "Name of location where Sentinel is deployed"
            key: "/location"
            example: "my-remote-office-nyc"
          - name: "id"
            type:
              name: "string"
              validation: "TODO"
            label: "Sentinel Id"
            description: "Unique Sentinel identifier in the location"
            key: "/id"
            example: "id: my-sentinel-nyc"
          - name: "broker-url"
            type:
              name: "url"
            label: "Message broker URL"
            description: "Message broker connection URL"
            key: "/broker-url"
            example: "ActiveMQ: failover:[tcp,ssl]://my-activemq-ip:61616, Kafka: broker-01:9092, broker-02:9092"
  # Java Agent
  - name: "java"
    label: "Java"
    description: "Java configuration parameters."
    categories:
  # Sentinel Environment
  - name: "environment"
    label: "Environment"
    description: "Sentinel Java environment settings"
    config:
      - name: "java-opts"
        type:
          name: "collection"
          strategy: "indexed"
          items:
            label: "Option"
            type:
              name: "string"
        label: "JVM Options"
        description: "Additional Java options"
        key: "/process-env/java-opts"
        example: "-Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=7896"
  # IPC Configuration
  - name: "ipc"
    label: "IPC"
    description: "Core, Sentinel, and Sentinel distributed inter-process communication (IPC) settings"
    categories:
      # IPC Configuration :: Kafka IPC
      - name: "kafka"
        label: "Kafka IPC"
        description: "Configuration settings for Kafka IPC"
        config:
          - name: "bootstrap-servers"
            type:
              name: "collection"
              strategy: "concat"
              items:
                label: "Server"
                type:
                  name: "host-with-port"
                separator: ","
            label: "Bootstrap Servers"
            description: "Kafka bootstrap servers"
            key: "/ipc/kafka/bootstrap.servers"
            example: "kafka-01-ip:9092, kafka-02-ip:9092"
          - name: "properties"
            type:
              name: "properties"
            label: "Properties"
            description: "Additional Kafka configuration properties"
            key: "/ipc/kafka"
            example: "compression.type: gzip"

  # Telemetry
  - name: "telemetry"
    label: "Telemetry"
    description: "Telemetry daemon configuration"
    categories:
      # Telemetry :: Flows
      - name: "flows"
        label: "Flows"
        description: "Configuration for network flow collectors"
        config:
          - name: "flow-adapter-def"
            type:
              name: "objects"
              fields:
                - name: "adapter-name"
                  label: "Adapter Name"
                  type:
                    name: "string"
                    validation: "TODO"
                - name: "class-name"
                  label: "Class Name"
                  type:
                    name: "string"
                    validation: "TODO"
                - name: "parameters"
                  label: "Parameters"
                  type:
                    name: "properties"
              index-type: "field"
              index-field: "adapter-name"
            label: "Flow Adapter Definition"
            description: "Configure adapter for network flow packets"
            key: "/telemetry/flows/adapters"
            example: "TODO"

