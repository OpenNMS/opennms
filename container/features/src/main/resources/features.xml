<?xml version="1.0" encoding="UTF-8"?>
<features
  name="opennms-${project.version}"
  xmlns="http://karaf.apache.org/xmlns/features/v1.4.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://karaf.apache.org/xmlns/features/v1.4.0 http://karaf.apache.org/xmlns/features/v1.4.0"
>
    <!-- Apache Camel features -->
    <repository>mvn:org.apache.camel.karaf/apache-camel/${camelVersion}/xml/features</repository>

    <!-- Apache CXF features -->
    <repository>mvn:org.apache.cxf.karaf/apache-cxf/${cxfVersion}/xml/features</repository>

    <!-- Apache ActiveMQ features -->
    <repository>mvn:org.apache.activemq/activemq-karaf/${activemqVersion}/xml/features</repository>

    <!-- Pax JDBC features -->
    <repository>mvn:org.ops4j.pax.jdbc/pax-jdbc-features/1.0.1/xml/features</repository>

    <feature name="opennms-amqp-event-forwarder" description="OpenNMS :: Features :: AMQP :: Event Forwarder" version="${project.version}">
      <feature>camel-core</feature>
      <feature>camel-blueprint</feature>
      <feature>camel-http</feature>
      <feature>camel-amqp</feature>
      <feature>guava</feature>

      <feature>opennms-core-camel</feature>
      <feature>opennms-dao-api</feature>

      <bundle>mvn:org.opennms.features.amqp/org.opennms.features.amqp.common/${project.version}</bundle>
      <bundle>mvn:org.opennms.features.amqp/org.opennms.features.amqp.event-forwarder/${project.version}</bundle>
    </feature>

    <feature name="opennms-amqp-event-receiver" description="OpenNMS :: Features :: AMQP :: Event Receiver" version="${project.version}">
      <feature>camel-core</feature>
      <feature>camel-blueprint</feature>
      <feature>camel-http</feature>
      <feature>camel-amqp</feature>
      <feature>guava</feature>

      <feature>opennms-core-camel</feature>
      <feature>opennms-dao-api</feature>

      <bundle>mvn:org.opennms.features.amqp/org.opennms.features.amqp.common/${project.version}</bundle>
      <bundle>mvn:org.opennms.features.amqp/org.opennms.features.amqp.event-receiver/${project.version}</bundle>
    </feature>

    <feature name="opennms-amqp-alarm-northbounder" description="OpenNMS :: Features :: AMQP :: Alarm Northbounder" version="${project.version}">
      <feature>camel-core</feature>
      <feature>camel-blueprint</feature>
      <feature>camel-http</feature>
      <feature>camel-amqp</feature>

      <feature>opennms-core-camel</feature>
      <!-- TODO -->
      <!-- <feature>opennms-alarm-api</feature> -->

      <bundle>mvn:org.opennms.features.amqp/org.opennms.features.amqp.common/${project.version}</bundle>
      <bundle>mvn:org.opennms.features.amqp/org.opennms.features.amqp.alarm-northbounder/${project.version}</bundle>
    </feature>

    <!-- Dependency features -->
    <feature name="atomikos" description="Atomikos :: TransactionEssentials" version="${atomikosVersion}">
      <bundle>wrap:mvn:com.atomikos/atomikos-util/${atomikosVersion}</bundle>
      <bundle>wrap:mvn:com.atomikos/transactions-api/${atomikosVersion}</bundle>
      <bundle>wrap:mvn:com.atomikos/transactions/${atomikosVersion}</bundle>
      <bundle>wrap:mvn:com.atomikos/transactions-jta/${atomikosVersion}</bundle>
      <bundle>wrap:mvn:com.atomikos/transactions-jdbc/${atomikosVersion}</bundle>
    </feature>

    <feature name="batik" description="Apache :: XML Graphics :: Batik" version="${batikVersion}">
      <bundle>wrap:mvn:xalan/xalan/2.7.2</bundle>
      <bundle>wrap:mvn:xalan/serializer/2.7.2</bundle>
      <bundle>wrap:mvn:xml-apis/xml-apis/1.4.01</bundle>
      <bundle>wrap:mvn:xml-apis/xml-apis-ext/1.3.04</bundle>

      <bundle>wrap:mvn:org.apache.xmlgraphics/batik-anim/${batikVersion}</bundle>
      <bundle>wrap:mvn:org.apache.xmlgraphics/batik-awt-util/${batikVersion}</bundle>
      <bundle>wrap:mvn:org.apache.xmlgraphics/batik-bridge/${batikVersion}</bundle>
      <bundle>wrap:mvn:org.apache.xmlgraphics/batik-css/${batikVersion}</bundle>
      <bundle>wrap:mvn:org.apache.xmlgraphics/batik-dom/${batikVersion}</bundle>
      <bundle>wrap:mvn:org.apache.xmlgraphics/batik-ext/${batikVersion}</bundle>
      <bundle>wrap:mvn:org.apache.xmlgraphics/batik-gvt/${batikVersion}</bundle>
      <bundle>wrap:mvn:org.apache.xmlgraphics/batik-parser/${batikVersion}</bundle>
      <bundle>wrap:mvn:org.apache.xmlgraphics/batik-script/${batikVersion}</bundle>
      <bundle>wrap:mvn:org.apache.xmlgraphics/batik-svggen/${batikVersion}</bundle>
      <bundle>wrap:mvn:org.apache.xmlgraphics/batik-svg-dom/${batikVersion}</bundle>
      <bundle>wrap:mvn:org.apache.xmlgraphics/batik-transcoder/${batikVersion}</bundle>
      <bundle>wrap:mvn:org.apache.xmlgraphics/batik-util/${batikVersion}</bundle>
      <bundle>wrap:mvn:org.apache.xmlgraphics/batik-xml/${batikVersion}</bundle>
    </feature>

    <feature name="bsf" description="Apache :: Bean Scripting Framework" version="${bsfVersion}">
      <bundle>wrap:mvn:bsf/bsf/${bsfVersion}</bundle>
    </feature>

    <feature name="c3p0" description="c3p0" version="${c3p0Version}">
      <feature>postgresql</feature>

      <!-- Add all possible JDBC drivers to the c3p0 import list so that it can classload them -->
      <bundle>wrap:mvn:com.mchange/c3p0/${c3p0Version}$Bundle-SymbolicName=c3p0&amp;Bundle-Version=${c3p0Version}&amp;Import-Package=javax.management,javax.naming,javax.sql,javax.xml.parsers,org.postgresql;resolution:=optional,org.w3c.dom</bundle>
    </feature>

    <feature name="hikari-cp" description="HikariCP" version="${hikaricpVersion}">
      <feature>postgresql</feature>

      <!-- HikariCP uses DynamicImport-Package=* so it can load any JDBC drivers -->
      <bundle>mvn:com.zaxxer/HikariCP/${hikaricpVersion}</bundle>
    </feature>

    <feature name="commons-beanutils" description="Apache :: commons-beanutils" version="${commonsBeanutilsVersion}">
      <feature>commons-collections</feature>

      <bundle>mvn:commons-beanutils/commons-beanutils/${commonsBeanutilsVersion}</bundle>
    </feature>

    <feature name="commons-codec" description="Apache :: commons-codec" version="${commonsCodecVersion}">
      <bundle>mvn:commons-codec/commons-codec/${commonsCodecVersion}</bundle>
    </feature>

    <feature name="commons-cli" description="Apache :: commons-cli" version="1.2">
      <bundle>mvn:commons-cli/commons-cli/1.2</bundle>
    </feature>

    <feature name="commons-collections" description="Apache :: commons-collections" version="${commonsCollectionsVersion}">
      <bundle>mvn:commons-collections/commons-collections/${commonsCollectionsVersion}</bundle>
    </feature>

    <feature name="commons-configuration" description="Apache :: commons-configuration" version="${commonsConfigurationVersion}">
      <feature>commons-beanutils</feature>
      <feature>commons-codec</feature>
      <feature>commons-digester</feature>
      <feature>commons-jxpath</feature>
      <feature>commons-lang</feature>
      <feature>javax.mail</feature>
      <feature>javax.servlet</feature>

      <bundle>wrap:mvn:org.apache.ant/ant/1.8.2</bundle>
      <bundle>mvn:commons-configuration/commons-configuration/${commonsConfigurationVersion}</bundle>
    </feature>

    <feature name="commons-beanutils" description="Apache :: commons-beanutils" version="${commonsBeanutilsVersion}">
      <feature>commons-collections</feature>

      <bundle>mvn:commons-beanutils/commons-beanutils/${commonsBeanutilsVersion}</bundle>
    </feature>

    <feature name="commons-digester" description="Apache :: commons-digester" version="${commonsDigesterVersion}">
      <feature>commons-beanutils</feature>

      <bundle>mvn:commons-digester/commons-digester/${commonsDigesterVersion}</bundle>
    </feature>

    <feature name="commons-exec" description="Apache :: commons-exec" version="1.2">
      <bundle>mvn:org.apache.commons/commons-exec/1.2</bundle>
    </feature>

    <feature name="commons-io" description="Apache :: commons-io" version="${commonsIoVersion}">
      <bundle>mvn:commons-io/commons-io/${commonsIoVersion}</bundle>
    </feature>

    <feature name="commons-jexl" description="Apache :: commons-jexl" version="${commonsJexlVersion}">
      <bundle>mvn:org.apache.commons/commons-jexl/${commonsJexlVersion}</bundle>
    </feature>

    <feature name="commons-jxpath" description="Apache :: commons-jxpath" version="${commonsJxpathVersion}">
      <feature>commons-beanutils</feature>
      <feature>javax.servlet</feature>

      <!-- jdom has OSGi issues... use the ServiceMix bundle for it -->
      <!-- @see https://developer.atlassian.com/docs/faq/plugin-framework-faq/using-jdom-in-osgi -->
      <!-- @see https://techotom.wordpress.com/2014/10/21/fixing-the-default-package-is-not-permitted-by-the-import-package-syntax-with-maven-bundle-plugin/ -->
      <!-- <bundle>wrap:mvn:jdom/jdom/1.0</bundle> -->
      <bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.jdom/1.1_4</bundle>
      <bundle dependency="true">wrap:mvn:javax.servlet.jsp/jsp-api/2.2</bundle>

      <bundle>mvn:commons-jxpath/commons-jxpath/${commonsJxpathVersion}</bundle>
    </feature>

    <feature name="commons-lang" description="Apache :: commons-lang" version="${commonsLangVersion}">
      <bundle>mvn:commons-lang/commons-lang/${commonsLangVersion}</bundle>
    </feature>

    <feature name="commons-lang3" description="Apache :: commons-lang3" version="${commonsLang3Version}">
      <bundle>mvn:org.apache.commons/commons-lang3/${commonsLang3Version}</bundle>
    </feature>

    <feature name="commons-net" description="Apache :: commons-net" version="3.6">
      <bundle>mvn:commons-net/commons-net/3.6</bundle>
    </feature>

    <feature name="dnsjava" description="dnsjava" version="${dnsjavaVersion}">
      <bundle dependency="true">wrap:mvn:org.dnsjava/dnsjava/${dnsjavaVersion}</bundle>
    </feature>

    <feature name="dropwizard-metrics" description="Dropwizard :: Metrics" version="${dropwizardMetricsVersion}">
      <bundle>mvn:io.dropwizard.metrics/metrics-core/${dropwizardMetricsVersion}</bundle>
    </feature>

    <feature name="fop" description="Apache :: XML Graphics :: FOP" version="${fopVersion}">
      <bundle>wrap:mvn:org.apache.xmlgraphics/fop/${fopVersion}</bundle>
    </feature>

    <feature name="gemini-blueprint" description="Eclipse :: Gemini Blueprint" version="${eclipseGeminiVersion}">
      <feature version="[4.2,4.3)">spring</feature>
      <bundle>mvn:org.eclipse.gemini.blueprint/gemini-blueprint-core/${eclipseGeminiVersion}</bundle>
      <bundle>mvn:org.eclipse.gemini.blueprint/gemini-blueprint-extender/${eclipseGeminiVersion}</bundle>
      <bundle>mvn:org.eclipse.gemini.blueprint/gemini-blueprint-io/${eclipseGeminiVersion}</bundle>
    </feature>

    <feature name="guava" description="Google :: Guava" version="${guavaVersion}">
      <bundle dependency="true">mvn:com.google.guava/guava/${guavaVersion}</bundle>
    </feature>

    <feature name="guava17" description="Google :: Guava" version="${guavaOldVersion}">
      <bundle dependency="true">mvn:com.google.guava/guava/${guavaOldVersion}</bundle>
    </feature>

    <!-- Use name hibernate36 so that we don't collide with Karaf 2.3.5+'s hibernate feature -->
    <feature name="hibernate36" description="Hibernate :: Hibernate ORM" version="3.6.10.Final">
      <bundle dependency="true">wrap:mvn:antlr/antlr/2.7.7$Import-Package=org.hibernate.hql.ast</bundle>
      <bundle dependency="true">wrap:mvn:dom4j/dom4j/1.6.1</bundle>
      <!-- Use geronimo-jta_1.1_spec instead of javax.transaction because the Apache projects use it -->
      <!-- <bundle dependency="true">wrap:mvn:javax.transaction/jta/1.1</bundle> -->
      <bundle dependency="true">mvn:commons-collections/commons-collections/3.2.2</bundle>
      <bundle dependency="true">mvn:org.apache.geronimo.specs/geronimo-jta_1.1_spec/1.1.1</bundle>
      <bundle dependency="true">mvn:org.javassist/javassist/3.18.2-GA</bundle>

      <bundle>wrap:mvn:org.hibernate.javax.persistence/hibernate-jpa-2.0-api/1.0.1.Final</bundle>
      <bundle>wrap:mvn:org.hibernate/hibernate-core/3.6.10.Final$Export-Package=org.hibernate*;version="3.6.10"</bundle>
      <bundle>wrap:mvn:org.hibernate/hibernate-commons-annotations/3.2.0.Final</bundle>
    </feature>

    <feature name="hibernate-validator41" description="Hibernate :: Hibernate Validator" version="4.1.0.Final">
      <feature>javax.validation</feature>
      <bundle>wrap:mvn:org.hibernate/hibernate-validator-annotation-processor/4.1.0.Final</bundle>
      <bundle>wrap:mvn:org.hibernate/hibernate-validator/4.1.0.Final</bundle>
    </feature>

    <feature name="java-native-access" description="Java Native Access (JNA)" version="${jnaVersion}">
      <bundle>mvn:net.java.dev.jna/jna/${jnaVersion}</bundle>
      <bundle>mvn:net.java.dev.jna/jna-platform/${jnaVersion}</bundle>
    </feature>

    <feature name="javax.mail" description="javax.mail" version="1.4.5">
      <bundle>mvn:javax.mail/mail/1.4.5</bundle>
    </feature>

    <feature name="javax.servlet" description="javax.servlet" version="3.1.0">
      <!-- Make sure that this matches the version from pax-jetty -->
      <bundle start-level="30">mvn:javax.servlet/javax.servlet-api/3.1.0</bundle>
    </feature>

    <feature name="javax.validation" description="javax.validation" version="1.0.0.GA">
      <!-- Declare versions for all exported packages -->
      <bundle dependency="true">wrap:mvn:javax.validation/validation-api/1.0.0.GA$Bundle-SymbolicName=javax.validation:validation-api&amp;Bundle-Version=1.0.0&amp;Export-Package=javax.validation;version="1.0.0",javax.validation.bootstrap;version="1.0.0",javax.validation.constraints;version="1.0.0",javax.validation.groups;version="1.0.0",javax.validation.metadata;version="1.0.0",javax.validation.spi;version="1.0.0"</bundle>
    </feature>

    <!-- This feature contains all of the dependencies from the dependencies/jaxb/pom.xml -->
    <feature name="jaxb" description="EclipseLink :: MOXy" version="${eclipselinkVersion}">
      <feature>javax.mail</feature>
      <bundle>mvn:org.eclipse.persistence/org.eclipse.persistence.moxy/${eclipselinkVersion}</bundle>
      <bundle>mvn:org.eclipse.persistence/org.eclipse.persistence.core/${eclipselinkVersion}</bundle>
      <bundle>mvn:org.eclipse.persistence/org.eclipse.persistence.asm/${eclipselinkVersion}</bundle>
      <bundle>mvn:org.eclipse.persistence/org.eclipse.persistence.antlr/${eclipselinkVersion}</bundle>
    </feature>

    <feature name="jcifs" description="jcifs" version="${jcifsVersion}">
      <bundle>wrap:mvn:org.samba.jcifs/jcifs/${jcifsVersion}</bundle>
    </feature>

    <feature name="jfreechart" description="JFree :: JFreeChart" version="1.0.13">
      <bundle>wrap:mvn:jfree/jfreechart/1.0.13</bundle>
      <bundle>wrap:mvn:jfree/jcommon/1.0.16</bundle>
    </feature>

    <feature name="jldap" description="OpenLDAP :: JLDAP" version="4.3">
      <bundle>wrap:mvn:com.novell.ldap/jldap/4.3</bundle>
    </feature>

    <feature name="joda-time" description="Joda :: Joda-Time" version="${jodaTimeVersion}">
      <bundle>mvn:joda-time/joda-time/${jodaTimeVersion}</bundle>
    </feature>

    <feature name="jolokia-client" description="Jolokia-Client" version="1.3.3">
      <feature>javax.servlet</feature>
      <feature>json-simple</feature>

      <bundle dependency="true">mvn:org.apache.httpcomponents/httpcore-osgi/${httpcoreVersion}</bundle>
      <bundle dependency="true">mvn:org.apache.httpcomponents/httpclient-osgi/${httpclientVersion}</bundle>

      <bundle>mvn:org.jolokia/jolokia-client-java/1.3.3</bundle>
    </feature>
    
    <feature name="jrobin" description="JRobin" version="1.6.0-SNAPSHOT">
      <bundle>mvn:org.jrobin/jrobin/1.6.0-SNAPSHOT</bundle>
    </feature>

    <feature name="json-lib" description="json-lib" version="2.2.3">
      <bundle>wrap:mvn:net.sf.ezmorph/ezmorph/1.0.6</bundle>
      <!-- Use the jdk15 qualifier -->
      <bundle>wrap:mvn:net.sf.json-lib/json-lib/2.2.3/jar/jdk15</bundle>
    </feature>

    <feature name="lmax-disruptor" description="LMAX :: Disruptor" version="3.3.2">
      <bundle>mvn:com.lmax/disruptor/3.3.2</bundle>
    </feature>

    <feature name="org.json" description="org.json" version="${jsonVersion}">
      <bundle>wrap:mvn:org.json/json/${jsonVersion}$Export-Package=org.json</bundle>
    </feature>
    
    <feature name="json-simple" description="json-simple" version="1.1.1">
      <bundle>wrap:mvn:com.googlecode.json-simple/json-simple/1.1.1</bundle>
    </feature>

    <feature name="owasp-encoder" description="OWASP :: Encoder" version="${owaspEncoderVersion}">
      <bundle>wrap:mvn:org.owasp.encoder/encoder/${owaspEncoderVersion}$Export-Package=org.owasp.encoder</bundle>
    </feature>

    <feature name="owasp-html-sanitizer" description="OWASP :: HTML Sanitizer" version="${owaspHtmlSanitizerVersion}">
      <feature>guava</feature>
      <bundle>wrap:mvn:com.googlecode.owasp-java-html-sanitizer/owasp-java-html-sanitizer/${owaspHtmlSanitizerVersion}$Export-Package=org.owasp.html</bundle>
    </feature>

    <feature name="postgresql" description="PostgreSQL :: JDBC Driver" version="${postgresqlVersion}">
      <feature>pax-jdbc-spec</feature>
      <bundle dependency="true">mvn:org.apache.geronimo.specs/geronimo-jta_1.1_spec/1.1.1</bundle>
      <bundle>wrap:mvn:org.postgresql/postgresql/${postgresqlVersion}</bundle>
    </feature>

    <feature name="rate-limited-logger" description="Rate Limited Logger" version="${rateLimitedLoggerVersion}">
      <feature>joda-time</feature>
      <bundle>wrap:mvn:com.swrve/rate-limited-logger/${rateLimitedLoggerVersion}</bundle>
    </feature>

    <feature name="spring-security32" description="Spring :: Security" version="${springSecurityVersion}">
      <!-- spring-web is necessary for HTTP remoting -->
      <feature version="[4.2,4.3)">spring-web</feature>
      <feature>commons-codec</feature>
      <feature>javax.servlet</feature>

      <bundle>wrap:mvn:org.springframework.ldap/spring-ldap-core/1.3.2.RELEASE$Export-Package=org.springframework.ldap*;version="1.3.2"</bundle>
      <bundle>mvn:org.springframework.security/spring-security-aspects/${springSecurityVersion}</bundle>
      <bundle>mvn:org.springframework.security/spring-security-core/${springSecurityVersion}</bundle>
      <bundle>mvn:org.springframework.security/spring-security-config/${springSecurityVersion}</bundle>
      <bundle>mvn:org.springframework.security/spring-security-ldap/${springSecurityVersion}</bundle>
      <bundle>mvn:org.springframework.security/spring-security-remoting/${springSecurityVersion}</bundle>
      <bundle>mvn:org.springframework.security/spring-security-web/${springSecurityVersion}</bundle>
    </feature>

    <feature name="spring-webflow" description="Spring :: Web Flow" version="${springWebFlowVersion}">
      <bundle>wrap:mvn:opensymphony/ognl/2.6.11</bundle>
      <bundle>wrap:mvn:org.springframework.webflow/spring-binding/${springWebFlowVersion}</bundle>
      <bundle>wrap:mvn:org.springframework.webflow/spring-js/${springWebFlowVersion}</bundle>
      <bundle>wrap:mvn:org.springframework.webflow/spring-js-resources/${springWebFlowVersion}</bundle>
      <bundle>wrap:mvn:org.springframework.webflow/spring-webflow/${springWebFlowVersion}</bundle>
    </feature>

    <feature name="jicmp" description="jicmp" version="2.0.1">
      <feature>guava</feature>
      <bundle>mvn:org.opennms/jicmp-api/2.0.1</bundle>
    </feature>

    <feature name="jicmp6" description="jicmp6" version="2.0.1">
      <bundle>mvn:org.opennms/jicmp6-api/2.0.1</bundle>
    </feature>
    
    <feature name="quartz" description="quartz" version="${quartzVersion}">
      <feature>c3p0</feature>
      <bundle>wrap:mvn:org.quartz-scheduler/quartz/${quartzVersion}</bundle>
    </feature>
    
    <feature name="twitter4j" description="Twitter4J" version="3.0.6">
      <bundle>wrap:mvn:org.twitter4j/twitter4j-core/3.0.6</bundle>
    </feature>
    
    <!-- OpenNMS features -->
    
    
    <feature name="opennms-activemq-pool" description="OpenNMS :: Features :: ActiveMQ :: Pool" version="${project.version}">
      <feature>activemq-client</feature>
      <feature>camel-core</feature>
      <feature>camel-jms</feature>
      <feature>opennms-core</feature>

      <!-- Missing dependency of activemq-client -->
      <bundle dependency="true">mvn:org.ow2.asm/asm-all/5.2</bundle>

      <bundle>mvn:org.opennms.features.activemq/org.opennms.features.activemq.pool/${project.version}</bundle>
    </feature>

    <feature name="opennms-bootstrap" description="opennms-bootstrap" version="${project.version}">
      <bundle>wrap:mvn:org.opennms/opennms-bootstrap/${project.version}</bundle>
    </feature>
    
    
    <feature name="opennms-core" description="OpenNMS :: Core" version="${project.version}">
      <feature version="[4.2,4.3)">spring</feature>
      <feature version="[4.2,4.3)">spring-orm</feature>

      <feature>commons-io</feature>
      <feature>dnsjava</feature>
      <feature>jaxb</feature>
      <feature>owasp-encoder</feature>
      <feature>owasp-html-sanitizer</feature>

      <!-- Used by org.opennms.core.spring -->
      <bundle dependency="true">wrap:mvn:javax.inject/javax.inject/1</bundle>
      <!-- Used by org.opennms.core.xml -->
      <bundle dependency="true">mvn:org.codehaus.jackson/jackson-core-asl/${jacksonVersion}</bundle>
      <bundle dependency="true">mvn:org.codehaus.jackson/jackson-mapper-asl/${jacksonVersion}</bundle>
      <bundle dependency="true">mvn:org.codehaus.jackson/jackson-xc/${jacksonVersion}</bundle>

      <bundle>mvn:org.opennms.core/org.opennms.core.api/${project.version}</bundle>
      <bundle>mvn:org.opennms.core/org.opennms.core.criteria/${project.version}</bundle>
      <bundle>mvn:org.opennms.core/org.opennms.core.lib/${project.version}</bundle>
      <bundle>mvn:org.opennms.core/org.opennms.core.logging/${project.version}</bundle>
      <bundle>mvn:org.opennms.core/org.opennms.core.soa/${project.version}</bundle>
      <bundle>mvn:org.opennms.core/org.opennms.core.spring/${project.version}</bundle>
      <bundle>mvn:org.opennms.core/org.opennms.core.xml/${project.version}</bundle>
      <bundle>mvn:org.opennms/opennms-util/${project.version}</bundle>
    </feature>

    <feature name="opennms-core-camel" description="OpenNMS :: Core :: Camel" version="${project.version}">
      <feature>camel-core</feature>
      <feature>camel-http</feature>
      <feature>camel-netty4</feature>

      <feature>opennms-core</feature>

      <bundle>mvn:org.opennms.core/org.opennms.core.camel/${project.version}</bundle>
    </feature>

    <feature name="opennms-core-daemon" description="OpenNMS :: Core :: Daemon" version="${project.version}">
      <feature>activemq-client</feature>
      <feature>camel-jms</feature>
      <feature>guava</feature>

      <feature>opennms-activemq-pool</feature>
      <feature>opennms-core</feature>
      <feature>opennms-config</feature>
      <feature>opennms-icmp-api</feature>
      <feature>opennms-model</feature>

      <!-- Missing dependency of activemq-client -->
      <bundle dependency="true">mvn:org.ow2.asm/asm-all/5.2</bundle>

      <bundle>mvn:org.opennms.core/org.opennms.core.daemon/${project.version}</bundle>
    </feature>

    <feature name="opennms-core-db" description="OpenNMS :: Core :: Database" version="${project.version}">
      <feature>atomikos</feature>
      <feature>c3p0</feature>
      <feature>hikari-cp</feature>
      <feature>commons-io</feature>
      <feature>postgresql</feature>

      <feature>opennms-core</feature>

      <bundle>mvn:org.opennms.core/org.opennms.core.db/${project.version}</bundle>
    </feature>

    <feature name="opennms-core-web" description="OpenNMS :: Core :: Web" version="${project.version}">
      <feature>opennms-core</feature>

      <bundle>mvn:org.apache.httpcomponents/httpcore-osgi/${httpcoreVersion}</bundle>
      <bundle>mvn:org.apache.httpcomponents/httpclient-osgi/${httpclientVersion}</bundle>
      <bundle>mvn:org.opennms.core/org.opennms.core.web/${project.version}</bundle>
    </feature>

    <!-- TODO: Remove dependencies on this Minion API bundle inside this features.xml -->
    <feature name="opennms-distributed-core-api" description="OpenNMS :: Distributed :: Core :: API" version="${project.version}">
      <bundle>mvn:org.opennms.features.distributed/core-api/${project.version}</bundle>
    </feature>

    <feature name="opennms-model" description="OpenNMS :: Model" version="${project.version}">
      <feature version="[4.2,4.3)">spring</feature>
      <feature version="[4.2,4.3)">spring-jdbc</feature>
      <feature version="[4.2,4.3)">spring-orm</feature>
      <feature version="[4.2,4.3)">spring-tx</feature>

      <feature>commons-io</feature>
      <feature>commons-lang</feature>
      <feature>dnsjava</feature>
      <feature>hibernate36</feature>
      <feature>jaxb</feature>

      <feature>opennms-core</feature>
      <feature>opennms-events-api</feature>
      <feature>opennms-poller-api</feature>
      <feature>opennms-rrd-api</feature>
      <feature>opennms-snmp</feature>

      <bundle>mvn:org.opennms/opennms-model/${project.version}</bundle>
    </feature>

    <feature name="opennms-collection-api" description="OpenNMS :: Collection :: API" version="${project.version}">
      <feature version="[4.2,4.3)">spring</feature>
      <feature>commons-jexl</feature>

      <feature>opennms-model</feature>

      <bundle>mvn:org.opennms.features.collection/org.opennms.features.collection.api/${project.version}</bundle>
    </feature>

    <feature name="opennms-collection-commands" description="OpenNMS :: Collection :: Shell Commands" version="${project.version}">
      <feature>dropwizard-metrics</feature>
      <feature>guava</feature>
      <!--
      These classes are in the system classpath inside OpenNMS
      <feature>opennms-collection-api</feature>
      -->
      <bundle>mvn:org.opennms.features.collection/org.opennms.features.collection.commands/${project.version}</bundle>
    </feature>

    <feature name="opennms-collection-core" description="OpenNMS :: Collection :: Core" version="${project.version}">
      <feature>opennms-collection-api</feature>
      <feature>opennms-config</feature>
      <feature>opennms-core-ipc-rpc-api</feature>
      <feature>opennms-dao-api</feature>

      <bundle>mvn:org.opennms.features.collection/org.opennms.features.collection.core/${project.version}</bundle>
    </feature>

    <feature name="opennms-collection-persistence-rrd" description="OpenNMS :: Collection :: Persistence :: RRD" version="${project.version}">
      <feature>opennms-collection-api</feature>
      <feature>opennms-dao-api</feature>
      <feature>opennms-rrd-api</feature>

      <bundle>mvn:org.opennms.features.collection/org.opennms.features.collection.persistence.rrd/${project.version}</bundle>
    </feature>

    <feature name="opennms-config-api" description="OpenNMS :: Configuration :: API" version="${project.version}">
      <feature>opennms-collection-api</feature>
      <feature>opennms-core</feature>
      <feature>opennms-model</feature>

      <bundle>mvn:org.opennms/opennms-config-api/${project.version}</bundle>
      <bundle>mvn:org.opennms/opennms-config-model/${project.version}</bundle>
      <bundle>mvn:org.opennms/opennms-config-jaxb/${project.version}</bundle>
    </feature>

    <feature name="opennms-config-jaxb" description="OpenNMS :: Configuration :: JAXB" version="${project.version}">
      <!-- Required for javax.persistence - some of the classes are annotated with JPA annotations -->
      <feature>hibernate36</feature>
      <feature>commons-lang</feature>

      <feature>opennms-collection-api</feature>
      <feature>opennms-core</feature>
      <feature>opennms-snmp</feature>

      <bundle>mvn:org.opennms/opennms-config-jaxb/${project.version}</bundle>
    </feature>

    <feature name="opennms-config" description="OpenNMS :: Configuration" version="${project.version}">
      <feature>c3p0</feature>
      <feature>hikari-cp</feature>
      <feature>commons-codec</feature>
      <feature>opennms-config-api</feature>
      <feature>opennms-core-db</feature>
      <feature>opennms-poller-api</feature>
      <feature>opennms-rrd-api</feature>
      <feature>opennms-snmp</feature>

      <bundle dependency="true">wrap:mvn:com.googlecode.concurrent-locks/concurrent-locks/1.0.0</bundle>
      <bundle dependency="true">wrap:mvn:org.jasypt/jasypt/1.9.0</bundle>

      <bundle>mvn:org.opennms/opennms-config/${project.version}</bundle>
    </feature>

    <feature name='opennms-kafka' description="OpenNMS :: Features :: Kafka" version="${project.version}">
      <bundle dependency="true">mvn:org.scala-lang/scala-library/2.11.11</bundle>
      <!-- NMS-8929: Upgrade Zookeeper to fix bug https://issues.apache.org/jira/browse/ZOOKEEPER-2056 -->
      <!-- <bundle dependency="true">mvn:org.apache.zookeeper/zookeeper/3.4.6</bundle> -->
      <bundle dependency="true">mvn:org.apache.zookeeper/zookeeper/3.4.10</bundle>
      <bundle dependency="true">mvn:com.fasterxml.jackson.core/jackson-databind/2.9.1</bundle>
      <bundle dependency="true">mvn:com.fasterxml.jackson.core/jackson-annotations/2.9.0</bundle>
      <bundle dependency="true">mvn:com.fasterxml.jackson.core/jackson-core/2.9.1</bundle>
      <bundle dependency="true">wrap:mvn:com.yammer.metrics/metrics-core/2.2.0$Bundle-Version=2.2.0&amp;Export-Package=*;-noimport:=true;version="2.2.0"</bundle>
      <bundle dependency="true">wrap:mvn:com.yammer.metrics/metrics-annotation/2.2.0$Bundle-Version=2.2.0&amp;Export-Package=*;-noimport:=true;version="2.2.0"</bundle>
      <bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.kafka_2.11/${kafkaStreamsBundleVersion}</bundle>
      <bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.kafka-clients/${kafkaStreamsBundleVersion}</bundle>
    </feature>

    <feature name='opennms-aws-sqs' description="OpenNMS :: Features :: AWS SQS" version="${project.version}">
      <bundle dependency="true">wrap:mvn:com.amazonaws/aws-java-sdk-core/${awsSdkVersion}</bundle>
      <bundle dependency="true">wrap:mvn:com.amazonaws/aws-java-sdk-sqs/${awsSdkVersion}</bundle>
      <bundle dependency="true">wrap:mvn:com.amazonaws/amazon-sqs-java-messaging-lib/${awsSqsMessagingVersion}</bundle>
      <bundle dependency="true">mvn:com.fasterxml.jackson.core/jackson-databind/${jackson2Version}</bundle>
      <bundle dependency="true">mvn:com.fasterxml.jackson.core/jackson-annotations/${jackson2Version}</bundle>
      <bundle dependency="true">mvn:com.fasterxml.jackson.core/jackson-core/${jackson2Version}</bundle>
    </feature>

    <feature name="opennms-core-ipc-sink-api" description="OpenNMS :: Core :: IPC :: Sink :: API" version="${project.version}">
      <feature>dropwizard-metrics</feature>
      <feature>guava</feature>
      <feature>javax.mail</feature>
      <feature>org.json</feature>
      <feature>rate-limited-logger</feature>

      <feature>opennms-core</feature>

      <bundle>mvn:org.opennms.core.ipc.sink/org.opennms.core.ipc.sink.api/${project.version}</bundle>
      <bundle>mvn:org.opennms.core.ipc.sink/org.opennms.core.ipc.sink.common/${project.version}</bundle>
      <bundle>mvn:org.opennms.core.ipc.sink/org.opennms.core.ipc.sink.xml/${project.version}</bundle>
    </feature>
    
    <feature name="opennms-core-ipc-sink-offheap" description="OpenNMS :: Core :: IPC :: Sink :: OffHeap" version="${project.version}">
      <feature>opennms-core-ipc-sink-api</feature>
      <bundle>mvn:org.opennms.core.ipc.sink/org.opennms.core.ipc.sink.offheap/${project.version}</bundle>
      <bundle>mvn:com.h2database/h2/1.4.197</bundle>
    </feature>

    <!-- CAMEL -->
    <feature name="opennms-core-ipc-sink-camel-common" description="OpenNMS :: Core :: IPC :: Sink :: Camel :: Common" version="${project.version}">
      <feature>opennms-core-ipc-sink-api</feature>
      <feature>opennms-core-camel</feature>
      <feature>opennms-dao-api</feature>
      <feature>opennms-distributed-core-api</feature>
      <feature>camel-blueprint</feature>
      <feature>camel-jms</feature>
      <bundle>mvn:org.opennms.core.ipc.sink.camel/org.opennms.core.ipc.sink.camel.common/${project.version}</bundle>
    </feature>

    <!-- For backwards compatibility we keep this name -->
    <feature name="opennms-core-ipc-sink-camel" description="OpenNMS :: Core :: IPC :: Sink :: Camel :: Client" version="${project.version}">
        <feature>opennms-core-ipc-sink-camel-common</feature>
        <bundle>mvn:org.opennms.core.ipc.sink.camel/org.opennms.core.ipc.sink.camel.client/${project.version}</bundle>
    </feature>

    <feature name="opennms-core-ipc-sink-camel-server" description="OpenNMS :: Core :: IPC :: Sink :: Camel :: Server" version="${project.version}">
        <feature>opennms-core-ipc-sink-camel-common</feature>
        <bundle>mvn:org.opennms.core.ipc.sink.camel/org.opennms.core.ipc.sink.camel.server/${project.version}</bundle>
    </feature>

    <!-- KAFKA -->
    <feature name="opennms-core-ipc-sink-kafka-common" description="OpenNMS :: Core :: IPC :: Sink :: Kafka :: Common" version="${project.version}">
        <feature>opennms-core-ipc-sink-api</feature>
        <feature>opennms-kafka</feature>
        <feature>opennms-core-camel</feature>
        <bundle>mvn:org.opennms.core.ipc.sink.kafka/org.opennms.core.ipc.sink.kafka.common/${project.version}</bundle>
    </feature>

    <!-- For backwards compatibility we keep this name -->
    <feature name="opennms-core-ipc-sink-kafka" description="OpenNMS :: Core :: IPC :: Sink :: Kafka :: Client" version="${project.version}">
      <feature>opennms-core-ipc-sink-kafka-common</feature>
      <bundle>mvn:org.opennms.core.ipc.sink.kafka/org.opennms.core.ipc.sink.kafka.client/${project.version}</bundle>
    </feature>

    <feature name="opennms-core-ipc-sink-kafka-server" description="OpenNMS :: Core :: IPC :: Sink :: Kafka :: Server" version="${project.version}">
        <feature>opennms-core-ipc-sink-kafka-common</feature>
        <bundle>mvn:org.opennms.core.ipc.sink.kafka/org.opennms.core.ipc.sink.kafka.server/${project.version}</bundle>
    </feature>

    <!-- AWS SQS -->
    <feature name="opennms-core-ipc-sink-aws-sqs" description="OpenNMS :: Core :: IPC :: Sink :: AWS SQS Impl." version="${project.version}">
      <feature>guava</feature>
      <feature>opennms-core-ipc-sink-api</feature>
      <feature>opennms-aws-sqs</feature>
      <bundle>mvn:org.opennms.core.ipc.common/org.opennms.core.ipc.common.aws-sqs/${project.version}</bundle>
      <bundle>mvn:org.opennms.core.ipc.sink.aws.sqs/org.opennms.core.ipc.sink.aws.sqs.common/${project.version}</bundle>
      <bundle>mvn:org.opennms.core.ipc.sink.aws.sqs/org.opennms.core.ipc.sink.aws.sqs.client/${project.version}</bundle>
    </feature>

    <feature name="opennms-core-ipc-rpc-api" description="OpenNMS :: Core :: IPC :: RPC :: API" version="${project.version}">
      <feature>camel-blueprint</feature>
      <feature>camel-jms</feature>
      <feature>org.json</feature>
      <feature>javax.mail</feature>

      <feature>opennms-core-camel</feature>
      <feature>opennms-distributed-core-api</feature>

      <bundle>mvn:org.opennms.core.ipc.rpc/org.opennms.core.ipc.rpc.api/${project.version}</bundle>
      <bundle>mvn:org.opennms.core.ipc.rpc/org.opennms.core.ipc.rpc.xml/${project.version}</bundle>
      <bundle>mvn:org.opennms.core.ipc.rpc/org.opennms.core.ipc.rpc.common/${project.version}</bundle>
      <bundle>mvn:org.opennms.core.ipc.rpc/org.opennms.core.ipc.rpc.camel/${project.version}</bundle>
    </feature>

    <feature name="opennms-core-ipc-rpc-jms" description="OpenNMS :: Core :: IPC :: RPC :: JMS Impl." version="${project.version}">
      <feature>opennms-core-ipc-rpc-api</feature>
      <feature>opennms-dao-api</feature>
      <bundle>mvn:org.opennms.core.ipc.rpc/org.opennms.core.ipc.rpc.jms-impl/${project.version}</bundle>
    </feature>

    <feature name="opennms-core-ipc-rpc-aws-sqs" description="OpenNMS :: Core :: IPC :: RPC :: AWQ SQS Impl." version="${project.version}">
      <feature>opennms-aws-sqs</feature>
      <feature>opennms-core-ipc-rpc-api</feature>
      <bundle>mvn:org.opennms.core.ipc.common/org.opennms.core.ipc.common.aws-sqs/${project.version}</bundle>
      <bundle>mvn:org.opennms.core.ipc.rpc/org.opennms.core.ipc.rpc.aws-sqs-impl/${project.version}</bundle>
    </feature>

    <feature name="opennms-core-ipc-rpc-kafka" description="OpenNMS :: Core :: IPC :: RPC :: Kafka Impl." version="${project.version}">
      <feature>opennms-kafka</feature>
      <feature>opennms-core-ipc-rpc-api</feature>
      <bundle>mvn:org.opennms.core.ipc.rpc/org.opennms.core.ipc.rpc.kafka/${project.version}</bundle>
    </feature>

    <feature name="opennms-core-ipc-rpc-commands" description="OpenNMS :: Core :: IPC :: RPC :: Shell Commands" version="${project.version}">
      <feature>dropwizard-metrics</feature>
      <feature>guava</feature>
      <feature>opennms-core-ipc-rpc-api</feature>
      <!-- Other dependencies are available via the root classloader -->
      <bundle>mvn:org.opennms.core.ipc.rpc/org.opennms.core.ipc.rpc.commands/${project.version}</bundle>
    </feature>

    <feature name="opennms-dao-api" description="OpenNMS :: DAO :: API" version="${project.version}">
      <feature>opennms-core</feature>
      <feature>opennms-model</feature>
      <feature>opennms-config-api</feature>

      <bundle>mvn:org.opennms.features.reporting/org.opennms.features.reporting.model/${project.version}</bundle>

      <!--
        We use this instead of org.opennms/opennms-dao-api as there are other bundles providing DAOs (e.g. bsm)
        and those are all merged together in the following bundle. Technically starting all API bundles would be
        sufficient, but this is consistent with dao-impl.
      -->
      <bundle>mvn:org.opennms.features.distributed/org.opennms.features.distributed.dao-api/${project.version}</bundle>
    </feature>

    <feature name="opennms-dao" description="OpenNMS :: DAO" version="${project.version}">
      <feature>commons-jxpath</feature>
      <feature>guava</feature>
      <feature>hibernate-validator41</feature>

      <feature>opennms-collection-api</feature>
      <feature>opennms-collection-core</feature>
      <feature>opennms-collection-persistence-rrd</feature>
      <feature>opennms-dao-api</feature>
      <!-- Parent Spring context -->
      <feature>opennms-core-daemon</feature>
      <feature>opennms-measurements-api</feature>
      <feature>opennms-xml-collector</feature>

      <!-- We really just need org.apache.httpcomponents out of here for opennms-xml-collector -->
      <feature>opennms-core-web</feature>

      <!--
        We this instead of org.opennms/opennms-dao as there are other bundles providing DAO implementations (e.g. bsm)
        and those are all merged together as one big classpath is required in order to use spring's datasource factory.
       -->
      <bundle>mvn:org.opennms.features.distributed/org.opennms.features.distributed.dao-impl/${project.version}</bundle>
    </feature>

    <feature name="opennms-events-api" description="OpenNMS :: Events :: API" version="${project.version}">
      <feature version="[4.2,4.3)">spring</feature>

      <feature>camel-core</feature>
      <feature>commons-lang3</feature>
      <feature>jaxb</feature>
      <feature>javax.validation</feature>

      <feature>opennms-core</feature>
      <!-- TODO: This is a weak dependency inside EventConstants that needs to be removed -->
      <feature>opennms-snmp</feature>
      <feature>opennms-core-ipc-sink-api</feature>

      <bundle>mvn:org.opennms.features.events/org.opennms.features.events.api/${project.version}</bundle>
    </feature>

    <feature name="opennms-events-commands" description="OpenNMS :: Events :: Shell Commands" version="${project.version}">
      <!-- Other dependencies are available via the root classloader -->
      <feature>commons-jexl</feature>
      <feature>dropwizard-metrics</feature>
      <feature>guava</feature>
       <!-- This is needed for reload:daemon command  -->
      <bundle>mvn:org.opennms.core/org.opennms.core.lib/${project.version}</bundle>
      <!--
      These classes are in the system classpath inside OpenNMS
      <feature>opennms-core</feature>
      <feature>opennms-events-api</feature>
      <feature>opennms-model</feature>
      -->

      <bundle>mvn:org.opennms.features.events/org.opennms.features.events.commands/${project.version}</bundle>
    </feature>

    <feature name="opennms-icmp-api" description="OpenNMS :: ICMP :: API" version="${project.version}">
      <feature>guava</feature>

      <feature>opennms-core</feature>

      <bundle dependency="true">mvn:org.opennms.lib/org.opennms.lib.tracker/${trackerVersion}</bundle>
      <bundle>mvn:org.opennms/opennms-icmp-api/${project.version}</bundle>
    </feature>

    <feature name="opennms-icmp-best" description="OpenNMS :: ICMP :: Best Match" version="${project.version}">
      <feature>opennms-icmp-api</feature>
      <feature>opennms-icmp-jna</feature>
      <feature>opennms-icmp-jni</feature>
      <feature>opennms-icmp-jni6</feature>

      <bundle>mvn:org.opennms/opennms-icmp-best/${project.version}</bundle>
    </feature>

    <feature name="opennms-icmp-jna" description="OpenNMS :: ICMP :: JNA" version="${project.version}">
      <feature>guava</feature>

      <feature>opennms-icmp-api</feature>
      <feature>java-native-access</feature>

      <bundle>mvn:org.opennms.core/org.opennms.core.icmp-jna/${project.version}</bundle>
      <bundle>mvn:org.opennms/opennms-icmp-jna/${project.version}</bundle>
    </feature>

    <feature name="opennms-icmp-jni" description="OpenNMS :: ICMP :: JNI" version="${project.version}">
      <feature>opennms-icmp-api</feature>
      <feature>jicmp</feature>

      <bundle>mvn:org.opennms/opennms-icmp-jni/${project.version}</bundle>
    </feature>

    <feature name="opennms-icmp-jni6" description="OpenNMS :: ICMP :: JNI (with IPv6 support)" version="${project.version}">
      <feature>opennms-icmp-jni</feature>
      <feature>jicmp6</feature>

      <bundle>mvn:org.opennms/opennms-icmp-jni6/${project.version}</bundle>
    </feature>

    <feature name="opennms-javamail" description="OpenNMS :: Javamail" version="${project.version}">
      <feature>commons-lang</feature>
      <feature>javax.mail</feature>

      <feature>opennms-core</feature>
      <feature>opennms-config-api</feature>

      <bundle>mvn:org.opennms/opennms-javamail-api/${project.version}</bundle>
    </feature>

    <feature name="opennms-poller-api" description="OpenNMS :: Poller :: API" version="${project.version}">
      <feature version="[4.2,4.3)">spring</feature>

      <feature>hibernate36</feature>

      <feature>opennms-core</feature>
      <bundle>mvn:org.opennms.features.poller/org.opennms.features.poller.api/${project.version}</bundle>
    </feature>

    <feature name="opennms-measurements-api" description="OpenNMS :: Measurements :: API" version="${project.version}">
      <feature version="[4.2,4.3)">spring</feature>

      <feature>commons-lang</feature>
      <feature>guava</feature>

      <bundle>mvn:org.opennms.features.measurements/org.opennms.features.measurements.api/${project.version}</bundle>
    </feature>

    <feature name="opennms-osgi-jsr223" description="OpenNMS :: OSGi JSR-223" version="${project.version}">
      <bundle>mvn:org.opennms.features/org.opennms.features.osgi-jsr223/${project.version}</bundle>
    </feature>

    <feature name="opennms-provisioning" description="OpenNMS :: Provisioning" version="${project.version}">
      <feature>commons-lang</feature>
      <feature>commons-beanutils</feature>
      <feature>javax.validation</feature>
      <feature>joda-time</feature>
      <feature>opennms-provisioning-api</feature>

      <bundle>mvn:org.opennms/opennms-provision-persistence/${project.version}</bundle>

      <!--
      These classes are in the system classpath inside OpenNMS
      <feature>opennms-core</feature>
      <feature>opennms-model</feature>
      <feature>opennms-provisioning-api</feature>
      -->
    </feature>

    <feature name="opennms-provisioning-api" description="OpenNMS :: Provisioning :: API" version="${project.version}">
      <bundle dependency="true">mvn:org.apache.mina/mina-core/${minaVersion}</bundle>
      <bundle dependency="true">mvn:io.netty/netty/3.9.4.Final</bundle>
      <bundle>mvn:org.opennms/opennms-provision-api/${project.version}</bundle>
    </feature>

    <feature name="opennms-rrd-api" description="OpenNMS :: RRD :: API" version="${project.version}">
      <feature version="[4.2,4.3)">spring</feature>

      <feature>opennms-core</feature>

      <bundle>mvn:org.opennms/opennms-rrd-api/${project.version}</bundle>
    </feature>

    <feature name="opennms-rrd-jrobin" description="OpenNMS :: RRD :: JRobin" version="${project.version}">
      <feature version="[4.2,4.3)">spring</feature>

      <feature>jrobin</feature>
      <feature>opennms-rrd-api</feature>

      <bundle>mvn:org.opennms/opennms-rrd-jrobin/${project.version}</bundle>
    </feature>

    <feature name="opennms-snmp" description="OpenNMS :: Core :: SNMP" version="${project.version}">
      <feature>org.json</feature>

      <bundle>mvn:org.opennms.core/org.opennms.core.logging/${project.version}</bundle>
      <bundle>mvn:org.opennms.core.snmp/org.opennms.core.snmp.api/${project.version}</bundle>
      <bundle>mvn:org.opennms.core.snmp/org.opennms.core.snmp.implementations.snmp4j/${project.version}</bundle>
      <bundle>mvn:org.opennms.core.snmp/org.opennms.core.snmp.joesnmp/${project.version}</bundle>
    </feature>

    <feature name="opennms-snmp-commands" description="OpenNMS :: Core :: SNMP :: Commands" version="${project.version}">
      <!--
      These classes are in the system classpath inside OpenNMS
      <feature>opennms-config-api</feature>
      <feature>opennms-snmp</feature>
      -->
      <bundle>mvn:org.opennms.core.snmp/org.opennms.core.snmp.commands/${project.version}</bundle>
    </feature>


    <feature name="opennms-icmp-commands" description="OpenNMS :: Core :: ICMP :: Commands" version="${project.version}">
        <feature>opennms-icmp-api</feature>

        <bundle>mvn:org.opennms/opennms-icmp-commands/${project.version}</bundle>
    </feature>

    <feature name="opennms-syslogd" description="OpenNMS :: Syslogd" version="${project.version}">
      <feature version="[4.2,4.3)">spring</feature>
      <feature>camel-core</feature>
      <feature>camel-http</feature>
      <feature>camel-netty4</feature>
      <feature>guava</feature>

      <feature>dropwizard-metrics</feature>

      <feature>opennms-core</feature>
      <feature>opennms-core-camel</feature>
      <feature>opennms-core-daemon</feature>
      <feature>opennms-core-db</feature>
      <feature>opennms-config</feature>
      <feature>opennms-dao-api</feature>
      <feature>opennms-core-ipc-sink-api</feature>

      <bundle>mvn:org.opennms.features.events/org.opennms.features.events.syslog/${project.version}</bundle>
    </feature>

    <feature name="opennms-syslogd-listener-javanet" description="OpenNMS :: Syslogd :: Listener :: java.net" version="${project.version}">
      <feature>camel-blueprint</feature>
      <feature>opennms-syslogd</feature>

      <bundle>blueprint:mvn:org.opennms.features.events/org.opennms.features.events.syslog/${project.version}/xml/blueprint-syslog-listener-javanet</bundle>
    </feature>

    <feature name="opennms-syslogd-listener-camel-netty" description="OpenNMS :: Syslogd :: Listener :: camel-netty" version="${project.version}">
      <feature>camel-blueprint</feature>
      <feature>opennms-syslogd</feature>

      <bundle>blueprint:mvn:org.opennms.features.events/org.opennms.features.events.syslog/${project.version}/xml/blueprint-syslog-listener-camel-netty</bundle>
    </feature>

    <feature name="opennms-trapd" description="OpenNMS :: Trapd" version="${project.version}">
      <feature version="[4.2,4.3)">spring</feature>
      <feature>camel-core</feature>
      <feature>camel-http</feature>
      <feature>guava</feature>

      <feature>opennms-distributed-core-api</feature>
      <feature>opennms-core</feature>
      <feature>opennms-core-camel</feature>
      <feature>opennms-core-daemon</feature>
      <feature>opennms-core-db</feature>
      <feature>opennms-config</feature>
      <feature>opennms-dao-api</feature>
      <feature>opennms-events-api</feature>
      <feature>opennms-snmp</feature>
      <feature>opennms-core-ipc-sink-api</feature>

      <bundle>mvn:org.opennms.features.events/org.opennms.features.events.traps/${project.version}</bundle>
    </feature>

    <feature name="tsrm-troubleticketer" version="${project.version}" description="OpenNMS :: Features :: Ticketing :: Tivoli Service Request Manager (TSRM)">
        <feature version="${cxfVersion}">cxf-jaxws</feature>
        <feature>javax.servlet</feature>

        <bundle>mvn:org.opennms.features.ticketing/org.opennms.features.ticketing.api/${project.version}</bundle>
        <bundle>mvn:org.opennms.features/opennms-integration-tsrm/${project.version}</bundle>
    </feature>

    <feature name="eif-adapter" version="${project.version}" description="OpenNMS :: Features :: EIF Adapter">
        <feature>camel-core</feature>
        <feature>camel-blueprint</feature>
        <feature>camel-netty4</feature>
        <feature>opennms-core-camel</feature>
        <feature>opennms-collection-api</feature>
        <feature>opennms-dao-api</feature>

        <bundle>mvn:org.opennms.features/org.opennms.features.eif-adapter/${project.version}</bundle>
    </feature>

    <feature name="smack" description="Ignite Realtime :: Smack" version="4.0.6">
      <bundle>wrap:mvn:org.igniterealtime.smack/smack-core/4.0.6</bundle>
      <bundle>wrap:mvn:org.igniterealtime.smack/smack-tcp/4.0.6</bundle>
      <bundle>wrap:mvn:org.igniterealtime.smack/smack-extensions/4.0.6</bundle>
      <bundle>wrap:mvn:org.igniterealtime.smack/smack-resolver-javax/4.0.6</bundle>
      <bundle>wrap:mvn:xmlpull/xmlpull/1.1.3.1</bundle>
    </feature>
    
    <feature name="wsman-integration" version="${project.version}" description="OpenNMS :: Features :: WS-Man Integration">
      <feature>guava17</feature>
      <feature>javax.servlet</feature>

      <!-- The version of Xerces, Xalan and BCEL declared here should match the
           versions declared in the parent pom of the corresponding CXF version -->
      <bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.xerces/2.11.0_1</bundle>
      <bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.bcel/5.2_4</bundle>
      <bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.xalan/2.7.2_3</bundle>
      <feature version="${cxfVersion}">cxf-jaxws</feature>
      <feature version="${cxfVersion}">cxf-ws-addr</feature>

      <feature>opennms-collection-api</feature>
      <feature>opennms-poller-monitors-core</feature>
      <feature>opennms-provisioning-api</feature>
      <feature>opennms-dao-api</feature>

      <bundle>mvn:org.opennms.core.wsman/org.opennms.core.wsman.api/${wsmanVersion}</bundle>
      <bundle>mvn:org.opennms.core.wsman/org.opennms.core.wsman.cxf/${wsmanVersion}</bundle>
      <bundle>mvn:org.opennms.features/org.opennms.features.wsman/${project.version}</bundle>
    </feature>

    <feature name="wmi-integration" version="${project.version}" description="OpenNMS :: Features :: WMI Integration">
      <feature>commons-cli</feature>

      <feature>opennms-collection-api</feature>
      <feature>opennms-provisioning-api</feature>

      <bundle dependency="true">wrap:mvn:org.jinterop/j-interop/${jinteropVersion}</bundle>
      <bundle dependency="true">wrap:mvn:org.jinterop/j-interopdeps/${jinteropVersion}</bundle>

      <bundle>mvn:org.opennms/opennms-wmi/${project.version}</bundle>
    </feature>

    <feature name="opennms-xml-collector" version="${project.version}" description="OpenNMS :: Protocols :: XML Collector">
      <bundle>wrap:mvn:com.jcraft/jsch/0.1.51</bundle>
      <bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.oro/2.0.8_6</bundle>
      <bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.ezmorph/1.0.6_1</bundle>
      <bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.json-lib/${jsonlibBundleVersion}</bundle>
      <feature>commons-io</feature>
      <feature>commons-jxpath</feature>
      <feature>commons-lang</feature>
      <feature>guava</feature>
      <feature>joda-time</feature>

      <bundle dependency="true">mvn:org.codehaus.jackson/jackson-core-asl/${jacksonVersion}</bundle>
      <bundle dependency="true">mvn:org.codehaus.jackson/jackson-mapper-asl/${jacksonVersion}</bundle>
      <bundle dependency="true">mvn:org.codehaus.jackson/jackson-xc/${jacksonVersion}</bundle>
      <bundle dependency="true">wrap:mvn:com.jcraft/jsch/0.1.51</bundle>
      <!-- <bundle dependency="true">wrap:mvn:net.sf.json-lib/json-lib/2.2.3//jdk15</bundle> -->
      <bundle dependency="true">wrap:mvn:org.jsoup/jsoup/${jsoupVersion}</bundle>

      <feature>opennms-core-web</feature>

      <bundle>mvn:org.opennms.protocols/org.opennms.protocols.xml/${project.version}</bundle>
    </feature>

    <feature name="opennms-provisioning-detectors" description="OpenNMS :: Provisioning :: Detectors" version="${project.version}">
      <feature>bsf</feature>
      <feature>commons-cli</feature>
      <feature>javax.servlet</feature>
      <feature>jcifs</feature>
      <feature>jldap</feature>
      <feature>spring-security32</feature>

      <feature>opennms-collection-api</feature>
      <feature>opennms-core-web</feature>
      <feature>opennms-icmp-api</feature>
      <feature>opennms-provisioning-api</feature>
      <feature>wsman-integration</feature>
      <feature>wmi-integration</feature>

      <!--
      These classes are in the system classpath inside OpenNMS
      <feature>opennms-config</feature>
      -->

      <bundle>mvn:org.opennms.core.jmx/org.opennms.core.jmx.api/${project.version}</bundle>
      <bundle>mvn:org.opennms.core.jmx/org.opennms.core.jmx.impl/${project.version}</bundle>
      <bundle>mvn:org.opennms/opennms-detector-bsf/${project.version}</bundle>
      <bundle>mvn:org.opennms/opennms-detector-datagram/${project.version}</bundle>
      <bundle>mvn:org.opennms/opennms-detector-generic/${project.version}</bundle>
      <bundle>mvn:org.opennms/opennms-detector-jdbc/${project.version}</bundle>
      <bundle>mvn:org.opennms/opennms-detector-jmx/${project.version}</bundle>
      <bundle>mvn:org.opennms/opennms-detector-lineoriented/${project.version}</bundle>
      <bundle>mvn:org.opennms/opennms-detector-simple/${project.version}</bundle>
      <bundle>mvn:org.opennms/opennms-detector-ssh/${project.version}</bundle>
      <bundle>mvn:org.opennms/opennms-detector-web/${project.version}</bundle>
      <bundle>mvn:org.opennms/opennms-detector-registry/${project.version}</bundle>
    </feature>

    <feature name="opennms-provisioning-shell" description="OpenNMS :: Provisioning :: Shell" version="${project.version}">
      <!-- Dependencies should be available from the parent classloader and from the ONMSGi registry -->
      <!--
      These classes are in the system classpath inside OpenNMS
      <feature>opennms-provisioning</feature>
      <feature>opennms-provisioning-detectors</feature>
      -->
      <bundle>mvn:org.opennms/opennms-provision-shell/${project.version}</bundle>
    </feature>
    
    <feature name="opennms-vmware" description="OpenNMS :: Integrations :: VMware Integration" version="${project.version}">
      <feature>commons-cli</feature>
      <feature>commons-io</feature>
      <feature>commons-lang</feature>
      <feature>guava</feature>

      <!--
      These classes are in the system classpath inside OpenNMS
      <feature>opennms-core</feature>
      <feature>opennms-provisioning</feature>
      -->

      <bundle dependency="true">mvn:org.apache.httpcomponents/httpcore-osgi/${httpcoreVersion}</bundle>
      <bundle dependency="true">mvn:org.apache.httpcomponents/httpclient-osgi/${httpclientVersion}</bundle>

      <bundle>wrap:mvn:com.toastcoders/yavijava/6.0.03</bundle>
      <bundle>wrap:mvn:org.sblim.slp/sblimSLPClient/1.17</bundle>
      <bundle>wrap:mvn:org.sblim.wbem/sblimCIMClient/1.17</bundle>
      <bundle>mvn:org.opennms/opennms-vmware/${project.version}</bundle>
    </feature>

    <feature name="opennms-poller-monitors-core" description="OpenNMS :: Poller :: Monitors :: Core" version="${project.version}">
      <feature>camel-core</feature>
      <feature>camel-http</feature>
      <feature>commons-io</feature>
      <feature>commons-jexl</feature>
      <feature>commons-lang</feature>
      <feature>commons-net</feature>
      <feature>dnsjava</feature>
      <feature>hibernate36</feature>
      <feature>jldap</feature>
      <feature>jolokia-client</feature>
      <feature>json-simple</feature>
      <feature>jcifs</feature>
      <feature>bsf</feature>

      <!-- We really just need org.apache.httpcomponents out of here -->
      <feature>opennms-core-web</feature>
      <feature>opennms-core-ipc-rpc-api</feature>
      <feature>opennms-icmp-api</feature> 
      <feature>opennms-poller-api</feature>
      <feature>opennms-dao-api</feature>
      <feature>opennms-config</feature>
      <feature>opennms-javamail</feature>

      <bundle>mvn:org.opennms.core.jmx/org.opennms.core.jmx.api/${project.version}</bundle>
      <bundle>mvn:org.opennms.core.jmx/org.opennms.core.jmx.impl/${project.version}</bundle>
      <bundle>mvn:org.opennms.features.poller.monitors/org.opennms.features.poller.monitors.core/${project.version}</bundle>
    </feature>

    <feature name="opennms-poller-shell" description="OpenNMS :: Poller :: Shell" version="${project.version}">
      <!--
      These classes are in the system classpath inside OpenNMS
      <feature>opennms-poller-api</feature>
      -->
      <bundle>mvn:org.opennms.features.poller/org.opennms.features.poller.shell/${project.version}</bundle>
    </feature>

    <feature name="opennms-situation-feedback" description="OpenNMS :: Features :: Situation-Feedback" version="${project.version}">
      <feature>opennms-osgi-core-rest</feature>
      <feature>opennms-jest</feature>
      <bundle>mvn:org.opennms.features.situation-feedback/org.opennms.features.situation-feedback.api/${project.version}</bundle>
      <bundle>mvn:org.opennms.features.situation-feedback/org.opennms.features.situation-feedback.elastic/${project.version}</bundle>
      <bundle>mvn:org.opennms.features.situation-feedback.rest/org.opennms.features.situation-feedback.rest.api/${project.version}</bundle>
      <bundle>mvn:org.opennms.features.situation-feedback.rest/org.opennms.features.situation-feedback.rest.impl/${project.version}</bundle>
    </feature>

    <feature name="kafka-streams" description="Kafka Streams" version="${kafkaStreamsVersion}">
      <!-- Wrap the kafka-streams bundle instead of using the servicemix implementation since the later doesn't include the required imports for rocksdb -->
      <bundle dependency="true">wrap:mvn:org.apache.kafka/kafka-streams/${kafkaStreamsVersion}$Bundle-Version=${kafkaStreamsVersion}&amp;Export-Package=*;-noimport:=true:version="${kafkaStreamsVersion}"</bundle>
      <bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.kafka-clients/${kafkaStreamsBundleVersion}</bundle>
      <bundle dependency="true">wrap:mvn:org.apache.kafka/connect-json/${kafkaStreamsVersion}</bundle>
      <bundle dependency="true">wrap:mvn:org.apache.kafka/connect-api/${kafkaStreamsVersion}</bundle>
      <bundle dependency="true">mvn:org.lz4/lz4-java/1.4</bundle>
      <bundle dependency="true">mvn:org.xerial.snappy/snappy-java/1.1.4</bundle>
       <!-- These are only needed for  servicemix implementation of kafka streams -->
<!--       <bundle dependency="true">mvn:com.fasterxml.jackson.core/jackson-databind/2.9.1</bundle>
      <bundle dependency="true">mvn:com.fasterxml.jackson.core/jackson-annotations/2.9.0</bundle>
      <bundle dependency="true">mvn:com.fasterxml.jackson.core/jackson-core/2.9.1</bundle> -->
      <bundle dependency="true">wrap:mvn:org.rocksdb/rocksdbjni/5.7.3</bundle>
    </feature>

    <feature name="opennms-kafka-producer" description="OpenNMS :: Kafka :: Producer" version="${project.version}">
      <feature version="${guavaVersion}">guava</feature>
      <feature version="${kafkaStreamsVersion}">kafka-streams</feature>
      <feature>opennms-collection-api</feature>
      <bundle>mvn:com.google.protobuf/protobuf-java/${protobuf3Version}</bundle>
      <bundle>mvn:org.opennms.features.kafka/org.opennms.features.kafka.producer/${project.version}</bundle>
    </feature>

    <feature name="opennms-telemetry-collection" description="OpenNMS :: Telemetry :: Collection" version="${project.version}">
      <feature>guava</feature>

      <feature>opennms-collection-api</feature>
      <feature>opennms-osgi-jsr223</feature>
      <bundle>mvn:org.opennms.core/org.opennms.core.lib/${project.version}</bundle>
      <bundle>mvn:org.opennms.features.telemetry.config/org.opennms.features.telemetry.config.api/${project.version}</bundle>
      <bundle>mvn:org.opennms.features.telemetry.adapters/org.opennms.features.telemetry.adapters.api/${project.version}</bundle>
      <bundle>mvn:org.opennms.features.telemetry.adapters/org.opennms.features.telemetry.adapters.collection/${project.version}</bundle>
    </feature>

    <feature name="opennms-telemetry-flow" description="OpenNMS :: Telemetry :: Flow" version="${project.version}">
      <feature>opennms-telemetry-collection</feature>
      <bundle>mvn:org.mongodb/bson/${bsonVersion}</bundle>
      <bundle>mvn:org.apache.commons/commons-csv/${commonsCsvVersion}</bundle>
      <bundle>mvn:org.opennms.features.telemetry.adapters/org.opennms.features.telemetry.adapters.flow/${project.version}</bundle>
    </feature>

    <feature name="opennms-telemetry-daemon" description="OpenNMS :: Telemetry :: Daemon" version="${project.version}">
      <feature>camel-netty4</feature>
      <!-- Needed to bootstrap opennms-core-ipc-sink-api Spring context -->
      <feature>camel-spring</feature>

      <feature>opennms-core-daemon</feature>
      <feature>opennms-core-ipc-sink-api</feature>
      <feature>opennms-dao-api</feature>
      <feature>opennms-dao</feature>
      <feature>opennms-telemetry-collection</feature>

      <bundle dependency="true">mvn:com.google.protobuf/protobuf-java/${protobufVersion}</bundle>

      <bundle>mvn:org.opennms.features.telemetry/org.opennms.features.telemetry.common/${project.version}</bundle>
      <bundle>mvn:org.opennms.features.telemetry/org.opennms.features.telemetry.daemon/${project.version}</bundle>
      <bundle>mvn:org.opennms.features.telemetry.adapters/org.opennms.features.telemetry.adapters.registry/${project.version}</bundle>
      <bundle>mvn:org.opennms.features.telemetry.config/org.opennms.features.telemetry.config.jaxb/${project.version}</bundle>
      <bundle>mvn:org.opennms.features.telemetry.listeners/org.opennms.features.telemetry.listeners.api/${project.version}</bundle>
      <bundle>mvn:org.opennms.features.telemetry.listeners/org.opennms.features.telemetry.listeners.udp/${project.version}</bundle>
    </feature>

    <feature name="opennms-telemetry-jti" description="OpenNMS :: Telemetry :: JTI" version="${project.version}">
      <feature>opennms-telemetry-collection</feature>
      <bundle>mvn:com.google.protobuf/protobuf-java/${protobufVersion}</bundle>
      <bundle>mvn:org.opennms.features.telemetry.adapters/org.opennms.features.telemetry.adapters.jti/${project.version}</bundle>
    </feature>
    
    <feature name="opennms-telemetry-nxos" description="OpenNMS :: Telemetry :: NX-OS" version="${project.version}">
      <feature>opennms-telemetry-collection</feature>
      <!-- Use a newer version of Google Protobuf -->
      <bundle>mvn:com.google.protobuf/protobuf-java/3.4.0</bundle>
      <bundle>mvn:org.opennms.features.telemetry.adapters/org.opennms.features.telemetry.adapters.nxos/${project.version}</bundle>
    </feature>

    <feature name="opennms-bundle-refresher" description="OpenNMS :: Vaadin-Theme Bundle Refresher">
        <bundle start-level="100">mvn:org.opennms.features.vaadin-components/bundle-refresher/${project.version}</bundle>
    </feature>

    <feature name="opennms-health" description="OpenNMS :: Health" version="${project.version}">
        <feature>dropwizard-metrics</feature>
        <bundle>mvn:org.opennms.core.health/org.opennms.core.health.api/${project.version}</bundle>
        <bundle>mvn:org.opennms.core.health/org.opennms.core.health.impl/${project.version}</bundle>
        <bundle>mvn:org.opennms.core.health/org.opennms.core.health.shell/${project.version}</bundle>
    </feature>

    <feature name="opennms-persistence" description="OpenNMS :: Persistence" version="${project.version}">
        <feature>opennms-model</feature>
        <feature>opennms-dao</feature>

        <bundle>mvn:org.opennms.features.distributed/org.opennms.features.distributed.datasource/${project.version}</bundle>
    </feature>

    <feature name="opennms-spring-extender" description="OpenNMS :: Spring Extender" version="${project.version}">
        <!--
          Technically only feature "spring" is required but to prevent other features installing different versions of spring,
          e.g. when "spring-jdbc" is installed in a different version, at this point all spring features are installed
          to avoid spring version mix ups.
        -->
        <feature version="[4.2,4.3)">spring</feature>
        <feature version="[4.2,4.3)">spring-jdbc</feature>
        <feature version="[4.2,4.3)">spring-orm</feature>
        <feature version="[4.2,4.3)">spring-jms</feature>
        <feature version="[4.2,4.3)">spring-tx</feature>

        <bundle dependency="true">mvn:com.google.guava/guava/18.0</bundle>
        <bundle dependency="true">mvn:org.opennms.core/org.opennms.core.soa/${project.version}</bundle>
        <bundle>mvn:org.opennms.container/spring-extender/${project.version}</bundle>
    </feature>


    <feature name="opennms-flows" description="OpenNMS :: Features :: Flows :: Feature Definition" version="${project.version}">
        <details>Feature definition to start all required bundles related to *flow-support.</details>
        <feature>opennms-health</feature>
        <feature>opennms-jest</feature>
        <feature>quartz</feature>
        <bundle>wrap:mvn:org.apache.commons/commons-csv/${commonsCsvVersion}</bundle>

        <bundle>mvn:org.opennms.features.flows/org.opennms.features.flows.api/${project.version}</bundle>
        <bundle>mvn:org.opennms.features.flows.classification.engine/org.opennms.features.flows.classification.engine.api/${project.version}</bundle>
        <bundle>mvn:org.opennms.features.flows.rest/org.opennms.features.flows.rest.api/${project.version}</bundle>

        <bundle>mvn:org.opennms/opennms-web-api/${project.version}</bundle>
        <bundle>mvn:org.opennms.features.flows.rest/org.opennms.features.flows.rest.impl/${project.version}</bundle>
        <bundle>wrap:mvn:org.freemarker/freemarker/${freemarkerVersion}</bundle>

        <bundle>mvn:org.opennms.features.flows.classification.engine/org.opennms.features.flows.classification.engine.impl/${project.version}</bundle>
        <bundle>mvn:org.opennms.features.flows/org.opennms.features.flows.elastic/${project.version}</bundle>
        <bundle>mvn:com.google.guava/guava/${guavaVersion}</bundle>
        <bundle>mvn:org.mongodb/bson/${bsonVersion}</bundle>
        <bundle>mvn:org.opennms.core/org.opennms.core.cache/${project.version}</bundle>
        <bundle>mvn:org.opennms.features.telemetry.adapters/org.opennms.features.telemetry.adapters.netflow/${project.version}</bundle>
    </feature>

</features>
