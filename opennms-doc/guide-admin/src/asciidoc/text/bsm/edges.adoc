
// Allow GitHub image rendering
:imagesdir: ../../../images

=== Edges

_Edges_ map the _Alarm_ status monitoring with _OpenNMS_

The following types can be used:

* _Child Service_: A reference to an existing _Business Service_ on which to depend
* _IP Service_: A convenient way to refer to the alarms that can be generated by a monitored _IP Service_. This will automatically provided edges for the _nodeLostService_, _interfaceDown_ and _nodeDown_ reductions keys of the specified service.
* _Reduction Key_: A resolved _Reduction Key_ used to refer to a specific _Alarm_, e.g. generated by a _SNMP Trap_ or _Threshold_ violation

TIP: If you need help determining the reduction key used by alarm, trigger the alarm in question and pull the reduction key from the _Alarm_ details page.

All edge types have the following parameters:

* _Map Function_: The associated _Map Function_ for this _Edge_
* _Weight_: The relative _Weight_ of this edge. Used by certain _Reduce Functions_.

Both _IP Service_ and _Reduction Key_ type edges also support a _Friendly Name_ parameter which gives the user control on how the edge is labeled in the _Topology User Interface_.
The editor changing the _Edge_ attributes is shown in figure <<ga-bsm-edge-edit, Editor to add Business Service Edges>>.

[[ga-bsm-edge-edit]]
.Editor to add Business Service Edges
image:bsm/02_bsm-edge-edit.png[Business Service Edge edit,400,199]

==== Child Services

To create a hierarchy of _Business Services_ they need to be created first.
The hierarchy is build by selecting the _Business Service_ as_Child Service_ as dependency.

==== IP Services

The _IP Service_ is a predefined set of _Reduction Keys_ which allows easily to assign a specific _Monitored Service_ to the given _BS_.
As an example you have multiple Servers with a _Monitored Service_ _SMTP_ and you want to model a _BS_ named _Mail Communication_.
If just the _Reduction Key_ for a _nodeLostService_ is assgined, the _BS_ would not be affected in case the _IP Interface_ or the whole _Node_ goes down.
_OpenNMS_ generates _Alarms_ with different _UEI_ which needs to be assigned to the _BS_ as well.
To make it easier to model this use case the _IP Service_ generates the following _Reduction Keys_ automatically:

* `uei.opennms.org/nodes/nodeLostService:%nodeId%:%ipAddress%:%serviceName%`: Matches _Alarms_ when the given _Monitored Service_ goes down
* `uei.opennms.org/nodes/interfaceDown:%nodeId%:%ipAddress%`: Matches _Alarms_ when the given _IP Interface_ of the _Monitored Service_ goes down
* `uei.opennms.org/nodes/nodeDown:%nodeId%`: Matches _Alarms_ when the given _Node_ of the _Monitored Service_ goes down

==== Custom Reduction Key

The _Reduction Key_ edge is used to refer to specific instance of alarms.
When an alarm with the given _Reduction Key_ is present, the alarms' severity will be used to calculate the _Operational Status_ of the _BS_.
To give a better explanation a _Friendly Name_ can be set and is used in the _Business Service View_.
The format of the _Reduction Key_ is build by a set of attributes as a key separated by `:` and enclosed in `%`, i.e (`%attribute%:%attribute%`).

.Example of a Reduction Key for a specific nodeLostService
[source]
----
%uei.opennms.org/nodes/nodeLostService%:%nodeId%:%ipAddress%:%serviceName%
----
