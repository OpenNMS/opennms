import{l as z,r as C,A as K,d as E,m as b,c as h,o as m,v as k,s as d,j as w,u as t,bd as G,z as A,B as U,D as H,aN as T,t as M,aO as Z,_ as I,k as f,b as D,G as S,F as B,x as P,be as J,f as N,a5 as Q,a6 as W}from"./index-CIzR5Qdh.js";const $=z("scvStore",()=>{const o=C([]),e=C({alias:"",username:"",password:"",attributes:{}}),s=C({}),l=C(!1),r=async()=>{const a=await K.getAliases();o.value=a},i=async a=>{const n=await K.getCredentialsByAlias(a);n&&(e.value=n,s.value=n,l.value=!0)},u=async()=>{await K.addCredentials(e.value)&&(y(),r())},V=async()=>{await K.updateCredentials(e.value)&&y()},c=a=>{e.value={...e.value,...a}},y=async()=>{const a={id:void 0,alias:"",username:"",password:"",attributes:{}};e.value=a,s.value=a,l.value=!1};return{aliases:o,credentials:e,dbCredentials:s,isEditing:l,getAliases:r,getCredentialsByAlias:i,addCredentials:u,updateCredentials:V,setValue:c,clearCredentials:y,addAttribute:()=>{e.value.attributes={...e.value.attributes,"":""}},updateAttribute:a=>{const n={...e.value.attributes};if(a.key===a.keyVal.key){n[a.key]=a.keyVal.value,e.value.attributes=n;return}delete n[a.key],n[a.keyVal.key]=a.keyVal.value,e.value.attributes=n},removeAttribute:a=>{const n={...e.value.attributes};delete n[a],e.value.attributes=n}}}),X=E({__name:"SCVList",setup(o){const e=$(),s=C(),l=b(()=>e.aliases),r=b(()=>e.isEditing),i=u=>{s.value=u,e.getCredentialsByAlias(u)};return(u,V)=>(m(),h(t(Z),{class:"scv-list"},{default:k(()=>[d(t(G),{class:"title"},{default:k(()=>V[0]||(V[0]=[A(" Aliases ")])),_:1,__:[0]}),(m(!0),w(U,null,H(t(l),c=>(m(),h(t(T),{selected:t(s)===c&&t(r),key:c,onClick:y=>i(c)},{default:k(()=>[A(M(c),1)]),_:2},1032,["selected","onClick"]))),128))]),_:1}))}}),Y=I(X,[["__scopeId","data-v-8926bf01"]]),ee=(o,e)=>{const s=o.__vccOpts||o;for(const[l,r]of e)s[l]=r;return s},te={},ae={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"};function se(o,e){return m(),w("svg",ae,e[0]||(e[0]=[f("path",{d:"M18,13H13v5a1,1,0,0,1-1,1h0a1,1,0,0,1-1-1V13H6a1,1,0,0,1-1-1H5a1,1,0,0,1,1-1h5V6a1,1,0,0,1,1-1h0a1,1,0,0,1,1,1v5h5a1,1,0,0,1,1,1h0A1,1,0,0,1,18,13Z"},null,-1)]))}const re=ee(te,[["render",se]]),ne={class:"attribute-container",id:"scv-attribute"},le=E({__name:"SCVAttribute",props:{attributeKey:{type:String,required:!0},attributeValue:{type:String,required:!0},attributeIndex:{type:Number,required:!0}},emits:["set-key-error"],setup(o,{emit:e}){const s=$(),l=e,r=o,i=C(),u=C(),V=b(()=>s.credentials),c=p=>{const a=Object.entries(V.value.attributes);for(const[n,[F]]of a.entries())if(p===F&&n!==r.attributeIndex)return u.value="Duplicate keys not allowed.",l("set-key-error",!0),!0;return u.value=null,l("set-key-error",!1),!1},y=p=>{c(p)||s.updateAttribute({key:r.attributeKey,keyVal:{key:p,value:r.attributeValue}})},g=p=>s.updateAttribute({key:r.attributeKey,keyVal:{key:r.attributeKey,value:p}}),x=()=>s.removeAttribute(r.attributeKey);return D(()=>i.value.focus()),(p,a)=>(m(),w("div",ne,[d(t(S),{"data-test":"attr-key",ref_key:"keyRef",ref:i,label:"key","onUpdate:modelValue":y,modelValue:o.attributeKey,error:t(u),class:"input"},null,8,["modelValue","error"]),d(t(S),{"data-test":"attr-value",label:"value","onUpdate:modelValue":g,modelValue:o.attributeValue,class:"input"},null,8,["modelValue"]),d(t(B),{icon:"Remove attribute",onClick:x,"data-test":"rm-attr-btn"},{default:k(()=>[d(t(P),{icon:t(J)},null,8,["icon"])]),_:1})]))}}),oe=I(le,[["__scopeId","data-v-e03ec60a"]]),ie={class:"form-container",id:"scv"},ue={class:"title"},de={autocomplete:"off",class:"row"},ce={class:"btns"},be=E({__name:"SCVForm",setup(o){const e=$(),s=C(!1),l=b(()=>e.dbCredentials),r=b(()=>e.aliases),i=b(()=>e.isEditing),u=b(()=>!!(!e.credentials.alias||y.value||c.value||s.value)),V=v=>{for(const _ of v)if(_!=="*")return!1;return!0},c=b(()=>{if(l.value.username&&e.credentials.password&&e.credentials.username!==l.value.username&&V(e.credentials.password))return"Password cannot be masked with updated usernames."}),y=b(()=>{if(!i.value&&e.credentials.alias&&r.value.includes(e.credentials.alias.toLowerCase()))return"Alias already in use."}),g=v=>s.value=v,x=v=>{e.setValue({alias:v.toLowerCase()})},p=v=>e.setValue({username:v}),a=v=>e.setValue({password:v}),n=()=>e.addCredentials(),F=()=>e.updateCredentials(),R=()=>e.clearCredentials(),q=()=>e.addAttribute();return(v,_)=>(m(),w("div",ie,[f("p",ue,M(t(i)?"Update":"Add")+" Credentials",1),d(t(S),{"data-test":"alias-input",disabled:t(i),label:"Alias","onUpdate:modelValue":x,modelValue:t(e).credentials.alias,error:t(y),class:"alias-input"},null,8,["disabled","modelValue","error"]),f("form",de,[d(t(S),{"data-test":"username-input",autocomplete:"new-username",label:"Username","onUpdate:modelValue":p,modelValue:t(e).credentials.username,class:"input"},null,8,["modelValue"]),d(t(S),{"data-test":"password-input",autocomplete:"new-password",label:"Password","onUpdate:modelValue":a,modelValue:t(e).credentials.password,error:t(c),class:"input"},null,8,["modelValue","error"])]),f("div",{class:"add-btn",onClick:q,"data-test":"add-attr-btn"},[d(t(P),{icon:t(re),"aria-hidden":"true",focusable:"false"},null,8,["icon"]),_[0]||(_[0]=A(" Add attribute "))]),(m(!0),w(U,null,H(t(e).credentials.attributes,(O,L,j)=>(m(),h(oe,{key:L,attributeKey:L,attributeValue:O,attributeIndex:j,onSetKeyError:g},null,8,["attributeKey","attributeValue","attributeIndex"]))),128)),f("div",ce,[t(i)?N("",!0):(m(),h(t(B),{key:0,"data-test":"add-creds-btn",disabled:t(u),primary:"",onClick:n},{default:k(()=>_[1]||(_[1]=[A(" Add Credentials ")])),_:1,__:[1]},8,["disabled"])),t(i)?(m(),h(t(B),{key:1,"data-test":"update-creds-btn",disabled:t(u),primary:"",onClick:F},{default:k(()=>_[2]||(_[2]=[A(" Update Credentials ")])),_:1,__:[2]},8,["disabled"])):N("",!0),d(t(B),{primary:"","data-test":"clear-btn",onClick:R},{default:k(()=>_[3]||(_[3]=[A(" Clear Form ")])),_:1,__:[3]})])]))}}),me=I(be,[["__scopeId","data-v-c6521de2"]]),pe={class:"feather-row"},ve={class:"feather-col-12"},_e={class:"scv-container"},fe={class:"list"},ye={class:"form"},Ve=E({__name:"SecureCredentialsVault",setup(o){const e=Q(),s=$(),l=b(()=>e.mainMenu.homeUrl),r=b(()=>[{label:"Home",to:l.value,isAbsoluteLink:!0},{label:"Secure Credentials Vault",to:"#",position:"last"}]);return D(()=>s.getAliases()),(i,u)=>(m(),w(U,null,[f("div",pe,[f("div",ve,[d(W,{items:t(r)},null,8,["items"])])]),f("div",_e,[f("div",fe,[d(Y)]),f("div",ye,[d(me)])])],64))}}),ke=I(Ve,[["__scopeId","data-v-a86d460e"]]);export{ke as default};
