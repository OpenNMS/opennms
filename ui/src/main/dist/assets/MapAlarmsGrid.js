import{d as T,m as A,r as k,n as M,S as n,b as D,ax as U,j as b,o as g,s as r,k as l,u as t,a0 as C,W as B,X as V,v as m,z as d,y as f,B as h,D as I,ay as G,q as F,t as v,_ as q}from"./index.js";import{u as P}from"./mapStore.js";const R={id:"wrap"},z={class:"tl1 tl2 tl3",summary:"Alarms"},$={class:"first-th"},H=T({__name:"MapAlarmsGrid",setup(Q){const S=P(),N=A(()=>S.getAlarms()),i=[{id:1,option:"Not Selected"},{id:2,option:"Acknowledge"},{id:3,option:"Unacknowledge"},{id:4,option:"Escalate"},{id:5,option:"Clear"}],_=k(i[0]),u=k(!1),p=k({}),O=A(()=>{let o=!1;for(const e in p.value)if(p.value[e]){o=!0;break}return!u.value&&!o}),x=o=>{p.value[o.id]=!p.value[o.id]},w=async()=>{let o={};switch(_.value.option){case i[0].option:break;case i[1].option:{o={ack:!0};break}case i[2].option:{o={ack:!1};break}case i[3].option:{o={escalate:!0};break}case i[4].option:{o={clear:!0};break}}const e=N.value.filter(E=>u.value||p.value[E.id]),y=[];for(const E of e){const L=await S.modifyAlarm({pathVariable:E.id,queryParameters:o});y.push(L)}(await Promise.all(y)).forEach(E=>{}),S.getAlarms(),u.value=!1,p.value={}},a=M({id:n.DESCENDING,severity:n.NONE,nodeLabel:n.NONE,uei:n.NONE,count:n.NONE,lastEventTime:n.NONE,logMessage:n.NONE}),c=o=>{for(const e in a)a[e]=n.NONE;a[`${o.property}`]=o.value,S.setAlarmSortObject(o)};return D(()=>{const o=document.getElementById("wrap"),e=document.querySelector("thead");o&&e&&o.addEventListener("scroll",function(){let y="translate(0,"+this.scrollTop+"px)";e.style.transform=y})}),(o,e)=>{const y=U("date");return g(),b(h,null,[r(t(B),{class:"select-ack",name:"alarmOptions",id:"alarmOptions",modelValue:t(_),"onUpdate:modelValue":[e[0]||(e[0]=s=>C(_)?_.value=s:null),w],disabled:t(O),options:i,"text-prop":"option",label:"Alarm Action"},null,8,["modelValue","disabled"]),l("div",R,[l("table",z,[l("thead",null,[l("tr",null,[l("th",$,[r(t(V),{modelValue:t(u),"onUpdate:modelValue":e[1]||(e[1]=s=>C(u)?u.value=s:null),label:"All"},null,8,["modelValue"])]),r(t(f),{scope:"col",property:"id",sort:t(a).id,onSortChanged:c},{default:m(()=>e[2]||(e[2]=[d("ID",-1)])),_:1,__:[2]},8,["sort"]),r(t(f),{scope:"col",property:"severity",sort:t(a).severity,onSortChanged:c},{default:m(()=>e[3]||(e[3]=[d("SEVERITY",-1)])),_:1,__:[3]},8,["sort"]),r(t(f),{scope:"col",property:"nodeLabel",sort:t(a).nodeLabel,onSortChanged:c},{default:m(()=>e[4]||(e[4]=[d("NODE LABEL",-1)])),_:1,__:[4]},8,["sort"]),r(t(f),{scope:"col",property:"uei",sort:t(a).uei,onSortChanged:c},{default:m(()=>e[5]||(e[5]=[d("UEI",-1)])),_:1,__:[5]},8,["sort"]),r(t(f),{scope:"col",property:"count",sort:t(a).count,onSortChanged:c},{default:m(()=>e[6]||(e[6]=[d("COUNT",-1)])),_:1,__:[6]},8,["sort"]),r(t(f),{scope:"col",property:"lastEvent",sort:t(a).lastEventTime,onSortChanged:c},{default:m(()=>e[7]||(e[7]=[d("LAST EVENT",-1)])),_:1,__:[7]},8,["sort"]),r(t(f),{scope:"col",property:"logMessage",sort:t(a).logMessage,onSortChanged:c},{default:m(()=>e[8]||(e[8]=[d("LOG MESSAGE",-1)])),_:1,__:[8]},8,["sort"])])]),l("tbody",null,[(g(!0),b(h,null,I(t(N),s=>(g(),b("tr",{key:s.id},[l("td",{class:F([s.severity,"first-td"])},[r(t(V),{"onUpdate:modelValue":E=>x(s),modelValue:t(u)||t(p)[s.id],label:"Alarm"},null,8,["onUpdate:modelValue","modelValue"])],2),l("td",null,v(s.id),1),l("td",null,v(s.severity),1),l("td",null,v(s.nodeLabel),1),l("td",null,v(s.uei),1),l("td",null,v(s.count),1),G((g(),b("td",null,[d(v(s.lastEventTime),1)])),[[y]]),l("td",null,v(s.logMessage),1)]))),128))])])])],64)}}}),Y=q(H,[["__scopeId","data-v-5fd38351"]]);export{Y as default};
