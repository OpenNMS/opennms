
= Edges

Edges map the alarm status monitoring with OpenNMS.

The following types can be used:

* Child Service: A reference to an existing business service on which to depend
* IP Service: A convenient way to refer to the alarms that can be generated by a monitored IP service. This will automatically provided edges for the nodeLostService, interfaceDown, and nodeDown reductions keys of the specified service.
* Reduction Key: A resolved reduction key used to refer to a specific alarm, e.g., generated by an SNMP trap or threshold violation
* Application: A reference to an existing application. This will automatically provide edges for the nodeLostService, interfaceDown, and nodeDown reductions keys of the defined services of this application.

TIP: If you need help determining the reduction key used by alarm, trigger the alarm in question and pull the reduction key from the alarm details page.

All edge types have the following parameters:

* Map Function: The associated Map Function for this edge.
* Weight: The relative Weight of this edge. Used by certain reduce functions.

Both IP Service and Reduction Key type edges also support a friendly name parameter which gives the user control on how the edge is labeled in the Topology User Interface.
The editor changing the edge attributes is shown in figure <<ga-bsm-edge-edit, Editor to add Business Service Edges>>.

[[ga-bsm-edge-edit]]
.Editor to add Business Service Edges
image::bsm/02_bsm-edge-edit.png[Business Service Edge edit,400,199]

== Child Services

To create a hierarchy of Business Services they need to be created first.
The hierarchy is build by selecting the Business Service as Child Service as dependency.

== IP Services

The IP Service is a predefined set of reduction keys that lets you easily assign a specific monitored service to the given BS.
As an example you have multiple Servers with a monitored service SMTP and you want to model a BS named Mail Communication.
If just the reduction key for a nodeLostService is assigned, the BS would not be affected in case the IP Interface or the whole Node goes down.
OpenNMS generates alarms with different UEI which needs to be assigned to the BS as well.
To make it easier to model this use case the IP Service generates the following reduction keys automatically:

* `uei.opennms.org/nodes/nodeLostService:%nodeId%:%ipAddress%:%serviceName%`: Matches alarms when the given monitored service goes down
* `uei.opennms.org/nodes/interfaceDown:%nodeId%:%ipAddress%`: Matches alarms when the given IP Interface of the monitored service goes down
* `uei.opennms.org/nodes/nodeDown:%nodeId%`: Matches alarms when the given Node of the monitored service goes down

== Custom Reduction Key

The reduction key edge is used to refer to specific instance of alarms.
When an alarm with the given reduction key is present, the alarms' severity will be used to calculate the operational status of the BS.
To give a better explanation a friendly name can be set and is used in the Business Service View.
The format of the reduction key is build by a set of attributes as a key separated by `:` and enclosed in `%`, i.e., (`%attribute%:%attribute%`).

.Example of a Reduction Key for a specific nodeLostService
[source]
----
%uei.opennms.org/nodes/nodeLostService%:%nodeId%:%ipAddress%:%serviceName%
----

== Application

Already defined Applications can be used in Business Service topologies.
An Application itself defines a set of monitored services - each of these generate nodeLostService, interfaceDown, and nodeDown reduction keys automatically.
