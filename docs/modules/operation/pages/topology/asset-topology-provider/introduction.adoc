
[[asset-topology]]
= Asset Topology Provider

{page-component-title} lets users define arbitrarily complex layered topologies using http://graphml.graphdrawing.org/[GraphML].
Refer to xref:development:topology/graphml.adoc#graphml[GraphML] for details of how {page-component-title} interprets GraphML.
The ability to display complex layered topologies is a great feature, but creating a usable GraphML topology for a large network can be a complex task.

The Asset Topology Provider avoids the need for users to work directly with GraphML, by directly generating a layered GraphML topology based on node parameters and the contents of the node asset table.
The Asset Topology Provider simplifies the task for many use cases by allowing users to define fields in the node asset table, which lets you position nodes correctly in a complex topology.
This lets you order nodes physically and logically, which makes it easier to represent and navigate your infrastructure.

The structure of the generated topology is determined by the `assetLayers` configuration constant that users can set.
To illustrate how this works, consider the following configuration:

[source, properties]
----
assetLayers=asset-region,asset-building
----

The {page-component-title} asset table is parsed to generate nested layers in the order of the comma-separated keys in the assetLayers property.
Each layer is a graph named after the key.
Graph nodes in each layer reference related graph nodes in the underlying layer.
The lowest layer contains graph nodes that are directly linked to monitored {page-component-title} nodes that have entries in the asset table.

The following diagram shows the structure of a topology generated by the above assetLayers property:

image:asset-topology/graphMLtopologyLayers.jpg[Illustrating how node asset entries are interpreted as layers]

In this example, the `region` asset fields for nodes 1, 2, 3, 4 are set to north.
All of these nodes are in the same north region.
The `building` asset fields for node 1 and node 2 are set to 21 (both nodes are in building 21), while the `building` asset fields for node 3 and node 4 are set to 22 (both nodes are in building 22).

The Asset Topology Provider generates four linked graphs for this configuration.
The layer 0 graph is called `asset-region`; the layer 1 graph is called `asset-building`; and the layer 2 graph is called `nodes`.

Conceptually, the topology is rendered as concentric sets.
The Asset Topology Provider first searches all of the nodes with regions defined and creates a new level 0 graph node representing each region found.
The Asset Topology Provider then searches within each region to find the building entries and creates a corresponding level 1 graph node for each building name found.
Finally, the Asset Topology Provider creates layer 2 nodes corresponding to each {page-component-title} monitored node and places each in the correct building.

{page-component-title}-monitored nodes that have empty region or building asset fields cannot be placed correctly in this topology.
These nodes are shown in the diagram as unallocated nodes.
Finally, only building and region nodes are generated which can be linked to {page-component-title} nodes in the topology.
The Asset Topology Provider does not generate spurious graph nodes in upper layers that are not directly and completely referenced by {page-component-title} nodes in the lowest layer.

Example screenshots of a topology containing regions, buildings, racks, and nodes:

image::asset-topology/AssetScreen1.png[Screenshot of Regions Layer,400,600]

image::asset-topology/AssetScreen2.png[Screenshot of Buildings Layer,400,600]

image::asset-topology/AssetScreen3.png[Screenshot of Nodes Layer,400,600]
